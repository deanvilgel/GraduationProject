var MapCamera=pc.createScript("mapCamera");MapCamera.prototype.initialize=function(){},MapCamera.prototype.update=function(a){var t=this.app.root.findByName("WalkPlayer").getPosition(),i=this.entity.getPosition();const e=this.app.root.findByTag("floorPlan").map((a=>a.getPosition().y)),o=e.map((a=>t.y-a-.7));let r=0,p=o.length-1;for(;r=o[p],!(r>=0);){if(p<=0){p=0;break}p--}this.entity.camera.nearClip=Math.floor(i.y-e[p]),this.entity.camera.farClip=Math.ceil(i.y-e[p])};var VideoTexture=pc.createScript("videoTexture");VideoTexture.attributes.add("video",{title:"Video",description:"MP4 video asset to play back on this video texture.",type:"asset"}),VideoTexture.attributes.add("playEvent",{title:"Play Event",description:"Event that is fired as soon as the video texture is ready to play.",type:"string",default:""}),VideoTexture.prototype.initialize=function(){var e=this.app,t=document.createElement("video");t.loop=!0,t.muted=!0,t.playsInline=!0,t.crossOrigin="anonymous",t.autoplay=!0;var i=t.style;i.width="1px",i.height="1px",i.position="absolute",i.opacity="0",i.zIndex="-1000",i.pointerEvents="none",document.body.appendChild(t),this.videoTexture=new pc.Texture(e.graphicsDevice,{format:pc.PIXELFORMAT_R8_G8_B8,minFilter:pc.FILTER_LINEAR_MIPMAP_LINEAR,magFilter:pc.FILTER_LINEAR,addressU:pc.ADDRESS_CLAMP_TO_EDGE,addressV:pc.ADDRESS_CLAMP_TO_EDGE,mipmaps:!0}),this.videoTexture.setSource(t),t.addEventListener("canplaythrough",function(i){e.fire(this.playEvent,this.videoTexture),t.play()}.bind(this)),t.src=this.video?this.video.getFileUrl():this.videoUrl,document.body.appendChild(t),t.load()},VideoTexture.prototype.update=function(e){this.videoTexture.upload()};pc.extend(pc,function(){var FxaaEffect=function(e){var o={aPosition:pc.SEMANTIC_POSITION},r=["attribute vec2 aPosition;","","void main(void)","{","    gl_Position = vec4(aPosition, 0.0, 1.0);","}"].join("\n"),a=["precision "+e.precision+" float;","","uniform sampler2D uColorBuffer;","uniform vec2 uResolution;","","#define FXAA_REDUCE_MIN   (1.0/128.0)","#define FXAA_REDUCE_MUL   (1.0/8.0)","#define FXAA_SPAN_MAX     8.0","","void main()","{","    vec3 rgbNW = texture2D( uColorBuffer, ( gl_FragCoord.xy + vec2( -1.0, -1.0 ) ) * uResolution ).xyz;","    vec3 rgbNE = texture2D( uColorBuffer, ( gl_FragCoord.xy + vec2( 1.0, -1.0 ) ) * uResolution ).xyz;","    vec3 rgbSW = texture2D( uColorBuffer, ( gl_FragCoord.xy + vec2( -1.0, 1.0 ) ) * uResolution ).xyz;","    vec3 rgbSE = texture2D( uColorBuffer, ( gl_FragCoord.xy + vec2( 1.0, 1.0 ) ) * uResolution ).xyz;","    vec4 rgbaM  = texture2D( uColorBuffer,  gl_FragCoord.xy  * uResolution );","    vec3 rgbM  = rgbaM.xyz;","    float opacity  = rgbaM.w;","","    vec3 luma = vec3( 0.299, 0.587, 0.114 );","","    float lumaNW = dot( rgbNW, luma );","    float lumaNE = dot( rgbNE, luma );","    float lumaSW = dot( rgbSW, luma );","    float lumaSE = dot( rgbSE, luma );","    float lumaM  = dot( rgbM,  luma );","    float lumaMin = min( lumaM, min( min( lumaNW, lumaNE ), min( lumaSW, lumaSE ) ) );","    float lumaMax = max( lumaM, max( max( lumaNW, lumaNE) , max( lumaSW, lumaSE ) ) );","","    vec2 dir;","    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));","    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));","","    float dirReduce = max( ( lumaNW + lumaNE + lumaSW + lumaSE ) * ( 0.25 * FXAA_REDUCE_MUL ), FXAA_REDUCE_MIN );","","    float rcpDirMin = 1.0 / ( min( abs( dir.x ), abs( dir.y ) ) + dirReduce );","    dir = min( vec2( FXAA_SPAN_MAX, FXAA_SPAN_MAX), max( vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX), dir * rcpDirMin)) * uResolution;","","    vec3 rgbA = 0.5 * (","        texture2D( uColorBuffer, gl_FragCoord.xy  * uResolution + dir * ( 1.0 / 3.0 - 0.5 ) ).xyz +","        texture2D( uColorBuffer, gl_FragCoord.xy  * uResolution + dir * ( 2.0 / 3.0 - 0.5 ) ).xyz );","","    vec3 rgbB = rgbA * 0.5 + 0.25 * (","        texture2D( uColorBuffer, gl_FragCoord.xy  * uResolution + dir * -0.5 ).xyz +","        texture2D( uColorBuffer, gl_FragCoord.xy  * uResolution + dir * 0.5 ).xyz );","","    float lumaB = dot( rgbB, luma );","","    if ( ( lumaB < lumaMin ) || ( lumaB > lumaMax ) )","    {","        gl_FragColor = vec4( rgbA, opacity );","    }","    else","    {","        gl_FragColor = vec4( rgbB, opacity );","    }","}"].join("\n");this.fxaaShader=new pc.Shader(e,{attributes:o,vshader:r,fshader:a}),this.resolution=new Float32Array(2)};return(FxaaEffect=pc.inherits(FxaaEffect,pc.PostEffect)).prototype=pc.extend(FxaaEffect.prototype,{render:function(e,o,r){var a=this.device,t=a.scope;this.resolution[0]=1/e.width,this.resolution[1]=1/e.height,t.resolve("uResolution").setValue(this.resolution),t.resolve("uColorBuffer").setValue(e.colorBuffer),pc.drawFullscreenQuad(a,o,this.vertexBuffer,this.fxaaShader,r)}}),{FxaaEffect:FxaaEffect}}());var Fxaa=pc.createScript("fxaa");Fxaa.prototype.initialize=function(){this.effect=new pc.FxaaEffect(this.app.graphicsDevice);var e=this.entity.camera.postEffects;e.addEffect(this.effect),this.on("state",(function(o){o?e.addEffect(this.effect):e.removeEffect(this.effect)})),this.on("destroy",(function(){e.removeEffect(this.effect)}))};var LookCamera=pc.createScript("lookCamera");LookCamera.attributes.add("mouseSensivity",{title:"Mouse Sensivity",type:"number",default:.3}),LookCamera.attributes.add("controllerTemplate",{title:"Controller Template",type:"asset",assetType:"template"}),LookCamera.prototype.initialize=function(){this._offsetParent=this.entity.parent;var t=this.entity.getRotation();this.yaw=pc.util.getYaw(t),this.pitch=this._getPitch(t,this.yaw),this.movedMouse=0,this.movedStart=0,this.touchCoords=new pc.Vec2,this.app.mouse.on(pc.EVENT_MOUSEDOWN,this._onMouseDown,this),this.app.mouse.on(pc.EVENT_MOUSEUP,this._onMouseUp,this),this.app.mouse.on(pc.EVENT_MOUSEMOVE,this._onMouseMove,this),this.app.mouse.disableContextMenu(),this.app.touch&&(this.app.touch.on(pc.EVENT_TOUCHSTART,this._onTouchStart,this),this.app.touch.on(pc.EVENT_TOUCHEND,this._onTouchEndCancel,this),this.app.touch.on(pc.EVENT_TOUCHCANCEL,this._onTouchStartEndCancel,this),this.app.touch.on(pc.EVENT_TOUCHMOVE,this._onTouchMove,this)),this.app.mainCamera=this.entity,this.gazeController=null,this.app.xr.active||(this.gazeController=this.controllerTemplate.resource.instantiate(),this.gazeController.reparent(this.app.root),this.gazeController.enabled=!0),this.app.xr.on("start",(function(){this.gazeController&&(this.gazeController.destroy(),this.gazeController=null)}),this),this.app.xr.on("end",(function(){this.gazeController||(this.gazeController=this.controllerTemplate.resource.instantiate(),this.gazeController.reparent(this.app.root),this.gazeController.enabled=!0)}),this)},LookCamera.prototype._onMouseDown=function(t){this.app.xr.active||t.button===pc.MOUSEBUTTON_LEFT&&(this.movedStart=Date.now(),this.movedMouse=0,this.gazeController&&this.gazeController.script.controller.onSelectStart())},LookCamera.prototype._onTouchStart=function(t){this.app.xr.active||(t.event.preventDefault(),1===t.touches.length&&(this.movedStart=Date.now(),this.movedMouse=0,this.touchCoords.set(t.touches[0].x,t.touches[0].y),this.gazeController&&(this.gazeController.script.controller.active=!0,this.gazeController.script.controller.mouseCoords.set(t.touches[0].x,t.touches[0].y),this.gazeController.script.controller.onSelectStart())))},LookCamera.prototype._onMouseUp=function(t){this.app.xr.active||t.button===pc.MOUSEBUTTON_LEFT&&this.gazeController&&(!pc.Mouse.isPointerLocked()&&(this.movedMouse>30||Date.now()-this.movedStart>300)&&(this.gazeController.script.controller.teleportable=!1),this.gazeController.script.controller.onSelectEnd(),this.gazeController.script.controller.teleportable=!0)},LookCamera.prototype._onTouchEndCancel=function(t){this.app.xr.active||0===t.touches.length&&this.gazeController&&((this.movedMouse>30||Date.now()-this.movedStart>300)&&(this.gazeController.script.controller.teleportable=!1),this.gazeController.script.controller.onSelectEnd(),this.gazeController.script.controller.teleportable=!0,this.gazeController.script.controller.active=!1)},LookCamera.prototype._onMouseMove=function(t){this.app.xr.active||(this.gazeController&&(this.gazeController.script.controller.mouseCoords.set(t.x,t.y),this.gazeController.script.controller.active=!0),!pc.Mouse.isPointerLocked()&&(!this.app.mouse.isPressed(pc.MOUSEBUTTON_LEFT)||this.gazeController&&this.gazeController.script.controller.getHeldEntity())||(this.pitch=Math.max(-90,Math.min(90,this.pitch-t.dy*this.mouseSensivity)),this.yaw-=t.dx*this.mouseSensivity,this.movedMouse+=Math.abs(t.dy)+Math.abs(t.dx)))},LookCamera.prototype._onTouchMove=function(t){if(!this.app.xr.active&&1===t.touches.length&&(this.gazeController&&this.gazeController.script.controller.mouseCoords.set(t.touches[0].x,t.touches[0].y),!this.gazeController||!this.gazeController.script.controller.getHeldEntity())){var o=t.touches[0].x-this.touchCoords.x,e=t.touches[0].y-this.touchCoords.y;this.touchCoords.set(t.touches[0].x,t.touches[0].y),this.pitch=Math.max(-90,Math.min(90,this.pitch-e*this.mouseSensivity)),this.yaw-=o*this.mouseSensivity,this.movedMouse+=Math.abs(e)+Math.abs(o)}},LookCamera.prototype.update=function(t){this._offsetParent.setLocalEulerAngles(0,this.yaw,0),this.app.xr.active||this.entity.setLocalEulerAngles(this.pitch,0,0)},LookCamera.quatWithoutYaw=new pc.Quat,LookCamera.yawOffset=new pc.Quat,LookCamera.prototype._getPitch=function(t,o){var e=LookCamera.quatWithoutYaw,s=LookCamera.yawOffset;s.setFromEulerAngles(0,-o,0),e.mul2(s,t);var r=new pc.Vec3;return e.transformVector(pc.Vec3.FORWARD,r),Math.atan2(r.y,-r.z)*pc.math.RAD_TO_DEG};var EvVrButton=pc.createScript("evVrButton");EvVrButton.attributes.add("blinkMultiplier",{type:"number",default:2}),EvVrButton.attributes.add("originalScale",{type:"number",default:.001}),EvVrButton.attributes.add("scaleFactor",{type:"number",default:.001}),EvVrButton.prototype.initialize=function(){this._time=0},EvVrButton.prototype.update=function(t){this._time+=this.blinkMultiplier*t;var i=(Math.sin(this._time)+1)/2*this.scaleFactor;this.entity.setLocalScale(this.originalScale+i,this.originalScale+i,this.originalScale+i)};var meta=document.querySelector("meta[name=viewport]");meta.setAttribute("content","width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, viewport-fit=cover");var Shape=pc.createScript("shape");Shape.attributes.add("type",{type:"string",enum:[{Sphere:"sphere"},{AABB:"aabb"},{OBB:"obb"}],default:"sphere",title:"Type"}),Shape.attributes.add("childOfActualEntity",{type:"boolean",default:!1,title:"Child Of Actual Entity",description:"Tick if the shape is a child of the actual entity object"}),Shape.attributes.add("keepUpdating",{type:"boolean",default:!1,title:"Keep Updating",description:"Update the shape data every frame (only toggle if the entity moves as can be expensive)"}),Shape.attributes.add("addToObject",{type:"string",enum:[{Global:"app"},{"Actual Entity":"actualEntity"}],title:"Add to Object",default:"app"}),Shape.prototype.initialize=function(){switch(this._halfExtents=this.entity.getLocalScale().clone().scale(.5),this.type){case"sphere":this._shape=new pc.BoundingSphere(this.entity.getPosition().clone(),Math.max(this._halfExtents.x,Math.max(this._halfExtents.y,this._halfExtents.z)));break;case"aabb":this._shape=new pc.BoundingBox(this.entity.getPosition().clone(),this._halfExtents);break;case"obb":this._worldTransform=(new pc.Mat4).setTRS(this.entity.getPosition(),this.entity.getRotation(),pc.util.DEFAULT_VEC3_1),this._shape=new pc.OrientatedBox(this._halfExtents,this._worldTransform)}},Shape.prototype.postInitialize=function(){this._getAddToObject().fire("shapeworld:add",this._getActualEntity(),this._shape)},Shape.prototype.update=function(t){if(this.keepUpdating)switch(this.type){case"sphere":case"aabb":this._shape.center.copy(this.entity.getPosition());break;case"obb":this._worldTransform.setTRS(this.entity.getPosition(),this.entity.getRotation(),pc.util.DEFAULT_VEC3_1),this._shape.worldTransform=this._worldTransform}},Shape.prototype._getAddToObject=function(){switch(this.addToObject){case"app":return this.app;case"actualEntity":return this._getActualEntity();default:return null}},Shape.prototype._getActualEntity=function(){return this.childOfActualEntity?this.entity.parent:this.entity};pc.DEFAULT_HUMAN_HEIGHT=1.67,function(){pc.util={},pc.util.DEBUG=!1,pc.util.DEFAULT_VEC3_0=new pc.Vec3(0,0,0),pc.util.DEFAULT_VEC3_1=new pc.Vec3(1,1,1),pc.util.DEFAULT_QUAT=new pc.Quat(0,0,0,1),pc.util.HIGHLIGHT_ENTITY_GREEN=new pc.Color(.25,.5,.25),pc.util.HIGHLIGHT_ENTITY_RED=new pc.Color(.25,.125,.125),pc.util.HIGHLIGHT_ENTITY_DEFAULT=new pc.Color(0,0,0),pc.util.setEntityAlpha=function(t,n){for(var e=pc.math.clamp(n,0,1),r=pc.util.getMeshInstances(t),i=0;i<r.length;++i)r[i].setParameter("material_opacity",e)},pc.util.setEntityEmissive=function(t,n){for(var e=pc.util.getMeshInstances(t),r=0;r<e.length;++r)e[r].setParameter("material_emissive",n.data3)},pc.util.isMobile=function(){return/Android/i.test(navigator.userAgent)||/iPhone|iPad|iPod/i.test(navigator.userAgent)},pc.util.canPlayOgg=function(){var t=navigator.userAgent.toLowerCase();return!(t.search("safari")>=0&&t.search("chrome")<0)},pc.util.unitCurve=function(t,n){if(1==n)return t;var e=t,r=n-n*e+e;return 0!==r&&(e/=r),e},pc.util.sCurve=function(t){return t*t*(3-2*t)},pc.util.playSoundSlot=function(t,n,e){if(t.sound){var r=t.sound.slots[n];return r&&(e&&(r.volume=e),r.play()),r}return null},pc.util.stopSoundSlot=function(t,n){if(t.sound){var e=t.sound.slots[n];return e&&e.stop(),e}return null},pc.util.pauseSoundSlot=function(t,n){if(t.sound){var e=t.sound.slots[n];return e&&e.pause(),e}return null},pc.util.isPlayingSoundSlot=function(t,n){if(t.sound){var e=t.sound.slots[n];if(e)return e.isPlaying}return!1},pc.util.initSoundSlotAssets=function(t,n){var e=pc.util.canPlayOgg()?".ogg":".mp3",r=n.sound?n.sound.slots:null,i=0;if(r)for(var o in r)if(r.hasOwnProperty(o)){var s=t.assets.find(o+e,"audio");s&&(r[o].asset=s.id,i+=1)}return i};var t=new pc.Vec3;pc.util.getYaw=function(n){var e=t;return n.transformVector(pc.Vec3.FORWARD,e),Math.atan2(-e.x,-e.z)*pc.math.RAD_TO_DEG};var n=new pc.Quat,e=new pc.Quat;pc.util.angleBetweenQuats=function(t,r){var i=n.copy(t).invert(),o=e.mul2(r,i),s=2*Math.acos(pc.math.clamp(o.w,-1,1))*pc.math.RAD_TO_DEG;return s>180&&(s=360-s),s},pc.util.clampQuatToYAxis=function(t){t.x=0,t.z=0;var n=Math.sqrt(t.w*t.w+t.y*t.y);t.w/=n,t.y/=n},pc.util.getMeshInstances=function(t){if(t.model)return t.model.meshInstances;var n=[];if(t instanceof pc.Entity)for(var e=t.findComponents("render"),r=0;r<e.length;++r)for(var i=e[r].meshInstances,o=0;o<i.length;o++)n.push(i[o]);return n}}(),pc.extend(pc,function(){var t=function OrientatedBox(t,n){this.halfExtents=t||new pc.Vec3(.5,.5,.5),this._worldTransform=n||new pc.Mat4,this._modelTransform=this._worldTransform.clone().invert(),this._aabb=new pc.BoundingBox(new pc.Vec3,this.halfExtents)},n=new pc.Ray,e=new pc.Vec3,r=new pc.BoundingSphere;return t.prototype={intersectsRay:function(t,e){if(this._modelTransform.transformPoint(t.origin,n.origin),this._modelTransform.transformVector(t.direction,n.direction),e){var r=this._aabb._intersectsRay(n,e);return this._worldTransform.transformPoint(e,e),r}return modelBox._fastIntersectsRay(this._transformedRay)},containsPoint:function(t){return this._modelTransform.transformPoint(t,e),this._aabb.containsPoint(e)},intersectsBoundingSphere:function(t){return this._modelTransform.transformPoint(t.center,r.center),r.radius=t.radius,!!this._aabb.intersectsBoundingSphere(r)}},Object.defineProperty(t.prototype,"worldTransform",{get:function(){return this._worldTransform},set:function(t){this._worldTransform=t,this._modelTransform.copy(this._worldTransform).invert()}}),{OrientatedBox:t}}()),pc.BoundingSphere.diffBetweenPoints=new pc.Vec3,pc.BoundingSphere.prototype.intersectsBoundingSphere=function(t){var n=pc.BoundingSphere.diffBetweenPoints;n.sub2(t.center,this.center);var e=t.radius+this.radius;return n.lengthSq()<=e*e},pc.BoundingBox.prototype._distanceToBoundingSphereSq=function(t){for(var n=this.getMin(),e=this.getMax(),r=0,i=0;i<3;++i){var o=0,s=t.center.data[i],a=n.data[i],u=e.data[i],c=0;s<a&&(o+=(c=a-s)*c),s>u&&(o+=(c=s-u)*c),r+=o}return r},pc.BoundingBox.prototype.intersectsBoundingSphere=function(t){return this._distanceToBoundingSphereSq(t)<=t.radius*t.radius};var TouchInputFly=pc.createScript("TouchInputFly");TouchInputFly.attributes.add("orbitSensitivity",{type:"number",default:.4,title:"Orbit Sensitivity",description:"How fast the camera moves around the orbit. Higher is faster"}),TouchInputFly.attributes.add("distanceSensitivity",{type:"number",default:.2,title:"Distance Sensitivity",description:"How fast the camera moves in and out. Higher is faster"}),TouchInputFly.prototype.initialize=function(){this.orbitCamera=this.entity.script.orbitCamera,this.lastTouchPoint=new pc.Vec2,this.lastPinchMidPoint=new pc.Vec2,this.lastPinchDistance=0,this.orbitCamera&&this.app.touch&&(this.app.touch.on(pc.EVENT_TOUCHSTART,this.onTouchStartEndCancel,this),this.app.touch.on(pc.EVENT_TOUCHEND,this.onTouchStartEndCancel,this),this.app.touch.on(pc.EVENT_TOUCHCANCEL,this.onTouchStartEndCancel,this),this.app.touch.on(pc.EVENT_TOUCHMOVE,this.onTouchMove,this),this.on("destroy",(function(){this.app.touch.off(pc.EVENT_TOUCHSTART,this.onTouchStartEndCancel,this),this.app.touch.off(pc.EVENT_TOUCHEND,this.onTouchStartEndCancel,this),this.app.touch.off(pc.EVENT_TOUCHCANCEL,this.onTouchStartEndCancel,this),this.app.touch.off(pc.EVENT_TOUCHMOVE,this.onTouchMove,this)})))},TouchInputFly.prototype.getPinchDistance=function(t,i){var o=t.x-i.x,n=t.y-i.y;return Math.sqrt(o*o+n*n)},TouchInputFly.prototype.calcMidPoint=function(t,i,o){o.set(i.x-t.x,i.y-t.y),o.scale(.5),o.x+=t.x,o.y+=t.y},TouchInputFly.prototype.onTouchStartEndCancel=function(t){var i=t.touches;1==i.length?this.lastTouchPoint.set(i[0].x,i[0].y):2==i.length&&(this.lastPinchDistance=this.getPinchDistance(i[0],i[1]),this.calcMidPoint(i[0],i[1],this.lastPinchMidPoint))},TouchInputFly.fromWorldPoint=new pc.Vec3,TouchInputFly.toWorldPoint=new pc.Vec3,TouchInputFly.worldDiff=new pc.Vec3,TouchInputFly.prototype.pan=function(t){var i=TouchInputFly.fromWorldPoint,o=TouchInputFly.toWorldPoint,n=TouchInputFly.worldDiff,h=this.entity.camera,c=this.orbitCamera.distance;h.screenToWorld(t.x,t.y,c,i),h.screenToWorld(this.lastPinchMidPoint.x,this.lastPinchMidPoint.y,c,o),n.sub2(o,i),this.orbitCamera.pivotPoint.add(n)},TouchInputFly.pinchMidPoint=new pc.Vec2,TouchInputFly.prototype.onTouchMove=function(t){var i=TouchInputFly.pinchMidPoint,o=t.touches;if(1==o.length){var n=o[0];this.orbitCamera.pitch-=(n.y-this.lastTouchPoint.y)*this.orbitSensitivity,this.orbitCamera.yaw-=(n.x-this.lastTouchPoint.x)*this.orbitSensitivity,this.lastTouchPoint.set(n.x,n.y)}else if(2==o.length){var h=this.getPinchDistance(o[0],o[1]),c=h-this.lastPinchDistance;this.lastPinchDistance=h,this.orbitCamera.distance-=c*this.distanceSensitivity*.1*(.1*this.orbitCamera.distance),this.calcMidPoint(o[0],o[1],i),this.pan(i),this.lastPinchMidPoint.copy(i)}};var LocatorRings=pc.createScript("locatorRings");LocatorRings.attributes.add("animLength",{type:"number",default:1,title:"Anim Length (secs)"}),LocatorRings.attributes.add("loopGap",{type:"number",default:1,title:"Loop Gap (secs)"}),LocatorRings.attributes.add("yOffsetCurve",{type:"curve",title:"Y Offset Curve"}),LocatorRings.attributes.add("scaleOffsetCurve",{type:"curve",title:"Scale Offset Curve"}),LocatorRings.attributes.add("alphaCurve",{type:"curve",title:"Alpha Curve"}),LocatorRings.prototype.initialize=function(){this._rings=this.entity.findByTag("locator-ring"),this._ringCount=this._rings.length,this._time=0,this._targetScaleY=1,this._setScaleY(.001),this.on("state",this._onStateChanged,this)},LocatorRings.ringPosition=new pc.Vec3,LocatorRings.SCALE_LERP_FACTOR=8,LocatorRings.prototype.update=function(t){var e=this._time/this.animLength,i=LocatorRings.ringPosition;LocatorRings.ringScale;if(e<=1)for(var a=0;a<this._ringCount;++a){var s=(e+1/this._ringCount*a)%1,o=this._rings[a];i.copy(o.getLocalPosition()),i.y=this.yOffsetCurve.value(s),o.setLocalPosition(i);var n=this.scaleOffsetCurve.value(s);o.setLocalScale(n,n,n),pc.util.setEntityAlpha(o,this.alphaCurve.value(s))}this._time=(this._time+t)%(this.animLength+this.loopGap);var r=this.entity.getLocalScale();this._setScaleY(pc.math.lerp(r.y,this._targetScaleY,Math.min(LocatorRings.SCALE_LERP_FACTOR*t,1)))},LocatorRings.prototype._onStateChanged=function(t){t&&(this._setScaleY(.001),this._targetScaleY=1)},LocatorRings.prototype._setScaleY=function(t){var e=this.entity.getLocalScale();e.y=t,this.entity.setLocalScale(e)};var TvScreen=pc.createScript("tvScreen");TvScreen.attributes.add("screenMaterial",{title:"Screen Material",description:"The screen material of the TV that displays the video texture.",type:"asset",assetType:"material"}),TvScreen.attributes.add("playEvent",{title:"Play Event",description:"Set the TV screen material emissive map on this event.",type:"string",default:""}),TvScreen.prototype.initialize=function(){this.app.on(this.playEvent,(function(e){var t=this.screenMaterial.resource;t.emissiveMap=e,t.update()}),this)};ShapeWorld=pc.createScript("shapeWorld"),ShapeWorld.prototype.initialize=function(){this._pickableEntities=[],this._pickableShapes=[],this.app.on("shapeworld:add",this.addItem,this),this.app.on("shapeworld:remove",this.removeItem,this),this.app.shapeWorld=this},ShapeWorld.hitPoint=new pc.Vec3,ShapeWorld.vecBetween=new pc.Vec3,ShapeWorld.prototype.raycast=function(e,t,i,p){for(var a=ShapeWorld.hitPoint,s=(ShapeWorld.vecBetween,p||1/0),h=null,n=0;n<this._pickableShapes.length;++n){var r=this._pickableShapes[n],o=this._pickableEntities[n];if((!t||t(o)&&o.enabled)&&r.intersectsRay(e,a)){var l=e.origin.distance(a);l<s&&(s=l,h=o,i&&i.copy(a))}}return h},ShapeWorld.prototype.containsPoint=function(e,t){for(var i=null,p=0;p<this._pickableShapes.length;++p){var a=this._pickableShapes[p],s=this._pickableEntities[p];if((!t||t(s)&&s.enabled)&&a.containsPoint(e)){i=s;break}}return i},ShapeWorld.prototype.intersectsSphere=function(e,t){for(var i=null,p=0;p<this._pickableShapes.length;++p){var a=this._pickableShapes[p],s=this._pickableEntities[p];if((!t||t(s)&&s.enabled)&&a.intersectsBoundingSphere(e)){i=s;break}}return i},ShapeWorld.prototype.addItem=function(e,t){e&&(this._pickableEntities.push(e),this._pickableShapes.push(t))},ShapeWorld.prototype.removeItem=function(e){var t=this._items.indexOf(e);t>=0&&(this._pickableEntities.splice(t,1),this._pickableShapes.splice(t,1))};pc.script.createLoadingScreen((function(A){var e,t;e=["body {","    background-color: #FFFFFF;","}","#application-splash-wrapper {","    position: relative;","    margin: 0 auto;","    height: 100%;","    width: 100%;","    background-color: #FFFFFF;","}","#application-splash {","    position: relative;","    top: calc(50% - 96px);","    width: 250px;","    left: calc(50% - 125px);","}","#application-splash img {","    width: 100%;","}","#progress-bar-container {","    margin: 20px 0 auto 0;","    height: 2px;","    width: 100%;","    background-color: #000000;","}","#progress-bar {","    width: 0%;","    height: 100%;","    background-color: #FFB40C;","}","@media (max-width: 480px) {","    #application-splash {","        position: relative;","        top: calc(50% - 65px);","        width: 170px;","        left: calc(50% - 85px);","    }","    #progress-bar-container {","        margin: 13px 0 auto 0;","        height: 2px;","        width: 100%;","        background-color: #000000;","}"].join("\n"),(t=document.createElement("style")).type="text/css",t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e)),document.head.appendChild(t),function(){var A=document.createElement("div");A.id="application-splash-wrapper",document.body.appendChild(A);var e=document.createElement("div");e.id="application-splash",A.appendChild(e),e.style.display="none";var t=document.createElement("img");t.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABAAAAAEACAYAAAAtJQQkAAAACXBIWXMAAAsSAAALEgHS3X78AAAgAElEQVR4nO3dv3Mcx5kw4JmrC5SgyMuYkc6Ukc6UEc6uCoHozJmg7MsEZZcJ+gsMZc4EZpcZDFDlzEDmzGDmzESm7IhComy+mp0eYQliF7sz78zObj9PFYp3MrmYnR89/b79dndZVVUBAAAA7Lb/cH0BAABg90kAAAAAQAYkAAAAACADEgAAAACQAQkAAAAAyIAEAAAAAGRAAgAAAAAyIAEAAAAAGZAAAAAAgAxIAAAAAEAGJAAAAAAgAxIAAAAAkAEJAAAAAMiABAAAAABkQAIAAAAAMiABAAAAABmQAAAAAIAMSAAAAABABiQAAAAAIAMSAAAAAJABCQAAAADIgAQAAAAAZEACAAAAADIgAQAAAAAZkAAAAACADEgAAAAAQAYkAAAAACADEgAAAACQAQkAAAAAyIAEAAAAAGRAAgAAAAAyIAEAAAAAGZAAAAAAgAxIAAAAAEAGJAAAAAAgAxIAAAAAkAEJAAAAAMiABAAAAABkQAIAAAAAMiABAAAAABmQAAAAAIAMSAAAAABABiQAAAAAIAMSAAAAAJABCQAAAADIgAQAAAAAZEACAAAAADIgAQAAAAAZkAAAAACADEgAAAAAQAYkAAAAACADEgAAAACQAQkAAAAAyIAEAAAAAGRAAgAAAAAyIAEAAAAAGZAAAAAAgAxIAAAAAEAGJAAAAAAgAxIAAAAAkAEJAAAAAMiABAAAAABkQAIAAAAAMiABAAAAABmQAAAAAIAMSAAAAABABiQAAAAAIAMSAAAAAJABCQAAAADIgAQAAAAAZEACAAAAADIgAQAAAAAZkAAAAACADEgAAAAAQAb+00UGtkFZlq+Kotif+6mdVFV1vMnDT8dV/7yY+88fi6K4qqrqYoOHBgAAnyirqnJGgMkpy3I+2H+95Ph+HDsJUJbl06IojoqiOCyK4vmSv3pTFMVpURTHVVV9HPEQAQDgMyoAgElYI+DfqLIs36Sg/skKx1H/ne/qREFZlkdVVZ262wAA2BQJAGAjtiXgn1eWZT3i/3OHf1onAn6uv3NVVYfDHSEAACwmAQCMYhsD/nnp+LsE//O+KcvyQiUAAACbIAEADGLbA/55ac5/VNB+kpIAH4I+DwAAViIBAITqUSY/ZY8t9reOejrAcfpMAAAYzX841UCwFzt4QqOD9TfBnwcAAI+SAAC23aB77afy/5fBH/skTZEAAIDRmAIwpvO9L4qi+NNav/Hg1mJhsFmvBvrtT11XAADGJAEwri/XLo8+3/uyOLj91/Z/deCeOrFw5qQAADAWUwDG9WWH39bl3wDT99E1AgBgTCoAxnK+91QCgBxUVXVcluVZKnF/lf7cT39Gz6Ufw1Db9V1N62sCALDrJADG0zWQ/6I433tVHNwKFtgaVVW19+tnC/SVZfkiTYWpkwI/TP071fv1l2V5k7bvi+SZBgBgVKYAjKfPQmKqANgZdUBdVdXF0Kv3B4ueq39ZVZUpAAAAjEoCYAxN+f+zHr/py7SDALAZx8G/NfrzAADgUaYAjCNiBP9LJcPwoMFH0tM0gJ+Kovgu4OPepQoIyEZZluvc81dVVR25O9gJ53tviqJY534+Mu0TGJIEwDgi9hGXAIAHzK03MKg6ICnLcr/nQobvi6I4dB3JSXpuXrvoZOpwzfv/qRsFGJIpAEPrX/7fMg0ANq8OZN51PIo6+N83958M7bvoZMz9D0yKBMDwIhfwsxggbFAdvFdVVZdzflsUxfWKR1LvIPBjVVWvBP9k6o0LT5bqXZzid5AB6EUCYHhfBf4GCQCYgKqqTquqqrcy/GNRFG/T6P689+m/14mCF1VVWfSPLJVl+bTDtJkP7hZ2hOQXMDnWABjS+d6z4LlczTSAg9tfp/dlIT9VVZ0NsEUg7JIuAZAEALtCAgCYHBUAw4pY/O8+VQAAbAvzn8lTswZUn0VjAQYhATCsIYJ1CQAAtoURUHLVNfllxydgUBIAQ4kv/299mbLKADBZZVlaAI2cdUt+HdxaLBYYlATAcIYo/2+pAgBg6pT/kzP3PzBJEgDDGTJIHzK5AAARlP+Tp2b7v+euPjBFEgBDGK78v/XMNAAApipt//faBSJTRv+ByZIAGMayEfqoLfxMAwBgqgRA5Mz9D0yWBMAwliUALoJ+o2kAAExVnwDIKuhsu69dQWCqJACine/VI/NfLPjUX4qD238EVQGYBgDAVPWZ/28VdLbX+Z61L4BJkwCIt6w0vx3V+FfQbzUNAIBJKcvyhQXQyJjyf2DSJADiLQvK/3Xvz75MAwBgaoyAkrM+9/+lOwcYmgRApMfL/5uyxoPbqASAaQAATI0RUPJ0vqf6BZi8/3SJQq1S/t/6V1AJ/6vAhQWn6Xzvi3SuvkrbK16ktRS6u/vMF+nnfiLll/Tzr8CETYhUXvtq7udp+r+fLPj8m3T/fUh/XlVVtdv3zESka1WPBh2m++y4qqqTLfwO++n428Bu2fZu79Mc7ot0z11UVfVhpMMdTNrWrr2WryKvZfrs/fS5++mZfrngr1/Ond+ziZ5bCYDit2Dwflu97Nm5nmunP6R33e4viHi+tz/Xxrx45P4v5kbJL9K5uvhtgGXz8rz328Go6VyHxern8uB2mu+k5jwezvUZDouD27OAz3yTfl49kKB6n56li96/K9r53qu5tuHVlrcNk1JWVZX7OYhzvvc/SyoATj65CZubOqJM8mNxcLtVAcXKPu083XfVqaFqAv//TsH/omt138dNd8TKsmwb7/2g0YWbuQDiNODz1laWZf1d/t73c6qqKsc/+sXuBYoPdfbfVlV1OJXjfcgA91sd2NTP62lVVVsV0KT79DCdj/tJts7Xcu4+edNzxfC683ayqed4XvpO9fn4c8+P+sPWJimbd3t7v0S11Wezn6l1zru66/+8eaQzv476OThN52kzwV3zvU4eSfI85rI4uJ1eEqHpjz30Mx+Q3czeGVNIWjVJpafFp4Mk89UZ71JwPY3gsFk48nDBu+Cn4uD2qMNnzgYdiqL4Zo1/Vb+rjzbW1nyarNhfMrC1js23DRMkARClKf//04JPq8v///LJf2kC0f8J+u1/KQ5ufxnjaw6uefjnR0sW+fycPqZ5IXy1RuB/X91w/G9xcBuxi8OjHgk8It2kxvFkzNHEXUsAlGV5uGIwd1lV1eQ6eGmk/3iE++06jZ5vPGBdZK5y4+ixIG7d+2/A8zzruFVVNWjHLT239zvWj43KbMJ4SYSmo92O2g1Z/n3dttVbN6rVvNuPRjhHRQru6nMUe/0/D4JXqcDbhPWTCE3y4qHnev3vdnA7/Dv57lrcP951ki/vioPbza1X0nyH9plYdo67XM/6HfNDj6N7mxIB47QzTf/8cM1kRReXs/dvdNuwhUwBiLNsQb7Ps6F1EHm+FzkN4G/Df8WB3JXjtxnaVTxb+WCaz//TGp+9SNPJO987HTIJkALJRaPHQ6hfPN/VP2VZ/pSCMyVTK5gbKR86aB5MCuiOR7zf6s7/z2VZHk8tEbBGEqfLZz9No4NDdXDq8/rXsizfpkRA2DNcluVJaiOY122ErY/nqVN/VJzv1QHu8eSvx/jnqEjP79fF+V7/zn4TGJ9t/bz+uwC/DSRXmc61WY+P4vc1/hpadyPcR4MkTZvrfBrw2d8sqcCN01Q+HI+YQH49G3iKaBu2nARAhLsAdpFFc8ijEgBfbmUC4HzvWRqRX6ccv8vvOAz8/Gep8f7foM/7TQrETjY8klZ38g/rQGjokcRtVZblq/Ty3tqgv7gbiT4ZIthdUZsImCW8NjWXve/1rAP7x4LtsiyPUidnjPtl1nGr25PAJIAdZ+Y1nfjjDSZFnswSAW3Z8BTXCWjO0ZAJr1W0nf2fUme/y/PwdEcW9es7NWE8/Uevp/id2oGCLs/DatetSZicBb5nXqZE4/rTDx7THOuYAw/3RbQNW80uADGWBfG/LLmxohaXe5oC3emrOwXne18V53t1g/L/UseyW3DeJF6W/e/RwX/ry5RlDVEHEGVZnqVy+CmU0T5JI4mnadQye3WQWI+ClmVZB6n/TC/xbQ7+j1Nl0qaC/3n1i/gqVVOMIj1zR0HXc2FbUCdZyrK8SHPix7xfXqaOINGajvyHiVREvJzdv837dDqa4/mw4eB/3nez9i7wvQ2Pqqtf6gD6fK9+Fv466PNwvneY+pDR75nvUrAeo4kBTtKxTiEhlW3bIAEQY53V/+80ZeRRSYBp37z1w3W+96c00vbfQaVXi5MewwX/rZAGMQU9HyYSiN1Xv6wuck0CpOBtPkj8bttHguYC0h8mlsBok06DljTXz1tKtv1fCsoHu57p2b7a5AhHKt0nQtNxPU0d+akl//6cjm2zmoBnEwmvVTyfLXzbJHBgGE07cZieg3+P0m9oAvSfB/wNMQnGJsi+muB0srZtmPTizNEkAPrqXv6/6v++qoipBLHqILx+2Ta7I7wZ7RibazJk8F9EVF2kznlUZ/J6tlJsUXxbL35VFMV/1YuTpQXKfpf+2x/Twi7reJlTEmAu6L9KL+9Bg8QxpSkmfQPSejXd7+fvsfrP9P9/n/73Pn6oK08iT8tc9cbH9LxFJ9s+S76mkv8pBIrfpetOH03H9aLnCF7bRv9h1ibXC6U1i6W1z867nkf5zUaTAE0QEpXwuknn4/sHzlfb3tQ/P6a/u6pZojG3jj4jqO//5vn7kILx2MTvolH4uzUqhtT/ndk8c//s2Z+6axPu2oO2f/tTamO7ejK7bhm1DdYA6K9r+X8rdhrApncDaILvduGQoaclLApKhw7+W51+RwqmT4MCkbdpa7WFC5mkudUf0u/u0oltkwCRc4onI3A7tlWNPl83zbPvM0JwmRbs++w+S/fERfo5CVhU8Ju66qKqqs7VAHPb0R2OMK3mk3YoJTCmUvpcpLam7wKo+boL/rsmc67THNOHg/NmEarZs5MWzOuzLkedBKg/c9xObNNpjhiBvE5tx9nCvlPz39t26CJdn3XPV93R/7gz2yrSVb91Z8bb/WPR72/7ktOejtgkRvq8E9+lHQk+v17Nf/uQ2oSj1BYd97geP6c2dLK7FEVRAdBft/L/1u5NA/gqlfiPsSbB5wmAJks61noIawfDKTC5CAg036dtrg7X2eoqBWtdRml3eU7xUeq8jjUNY9QkSkDw/2O9beGq91n999I2h9/3+J0/pOPu6ihVb4y6psYEg//a857nMl9NZ7JP8P929l5etTNZd2abbcn+uObI9rxv0hzbcTQLtvUN/m9m7cXB7YvZuVpvQa6uCdXTzOb9XgRUaK0i4ndcjXSsfReePUzT6TZVJbjpRaMf1y/4v5m1hXWbuOr+/U1b+6pDteu8kxzaBhUAffQv/5//e/nuBhClKckfr9x1zVVD54L/vg32T1VV9ZmTddXxGOo5xcd9RmYZV0Dw/23XbfqqqmrL7rv+/vrfX1VVNb0Vzj81a3MmGvy3jtJIUVerXoOnQR3Sy4DP6Jdo6z+vtg5ouwXi9ch08/u7Jh++m81BHnqEO2a19vez6qtVO/ifu+h4DE9SEmD/kXf5xzXux/X3zP/cdUBg+tDW07NtV9Oo8avUbu0HHfO8/gnu5r5t7t3mOdifO+atXXy3p/25ypf2vIz1vulWWt8/+N/vtMNJ8zwfzkbyu/3+J7P7r04C7PDuABIA/SzLEK1S/t+KnAbwoseLdNvcrwD47xGPv8tUi4jgv3NANueqR6Ncj8yebUFQlr1NBv+t+t+XZT1Nr9NxPElB6+Qz8RMP/msv67UQuj63qyYc0/SPv3f5Hfd+32bXLeg/r/Zt5+C/VXd8m07+Pzt+wmnqDwzTgW2qIyKC/8cC8Mf0eRe9TMmxxUntJgBZ7X5sFn7rO/f7NAXrw7ibQjEfTL5I3/FwclsF3k2Radwda58y710wZon6+s9YU4U0fvA/r54K1T0J8DzdY9PaYSWQKQD9LOuYrn7j5rQbQKy7BEDTYVs2z7UO2H8N/O1rJVlSgDCF4L8ImINuZfGJS3vb97lOPwXda0X6nK4LnL1MC+pN2es1OxiXafGyeuGi3z+wWGfEYooPMQ1gFc0IaZ+y/8uwOfhNB/jHjv/6yWBtdcyq4xHBfxvQ9nlefkhBZb6aqSennwTaU3V3rLkMdLXm+7uPJT/6LIb3kPXuiyY52Gel/6PewX+raYu7tg+xWyBOjARAV00nYdlc83UD+qjGbHq7AYxj2UP6S8qWRpZDrtw4pZHYvqODkQFZ35f8ayuLT1eaanLWZ9GynlNMHnLYY07z8Q7sQvE+7dDxX2k9heO0VsJv7Ui9WGf6bydVVb1KyYCu5+whtj9bTZ9n5yY80dKMBnft0H8TPpe1CZb7vkuvQ4L/O32DBdPamLrmOW5ij2Xv57eztTSa902U1Z/3pr3pkxx8N8ACfH36MzvbNkgAdNd39f/7oioAvijO9zaZBKgTGf9Ifw69I0ETFDQNzqIA4ZdUUvdrcXD7r6AkwIdVd1sIGImtvR8gIOs7x3aXyqIu0ijbZdDc40077VkaGT5SnBaf7PocPOlwv81f0zEWk1rkMi3WWZffn66zi0ZK1O0HJgHqxQDtBrBMM7LWpwT6ZKApeH06odEd2IhVx98ET03omwD4JvsqgEZOFaQRLtL2c2O+Z46WPH9vf6s+aoLoiCTA25XbtLtdCbq6GaRv2Uwj6dq3e72rVQDWAOgupvy/Vb8Mz/d+CVrB/svAhMJ67rbkuNMslvgsbZvX/vnlkqB9Ve2//2rB378L/lvNvMqix2jYr2smEU4COktDlO723a/56zqYSFsMbrUUaH1WFTFX5dD++WbqK+6WZdl3K8PLgAqRRU57zBlePk/3noeuaaoiaJOF7Z9vBppHOuvIBKyhcJWuae959cmrDEtnV9MkkvvMab8ebO523Zlv5tR2eZd8HbY20PneUcAc8R/DynvvRLRZb0xv690ny8v99QmK3ypk7v/sB7xn2muzqD/4/rOpR027UfQYkV83ID/q2UcaKoFapGe7a9t1POoC4yNRAdBFfPl/K+qlOK1pAM3o+4fZCHzdYB7c/i3suzaN7UPXog7U//eT4P/ueOrf/ZeOq9Uu3p/4njR3uW9n6aeBFtyL+MydLilO5dgXqVx78ovBpAC3bwd2sHK3lCzqOkrypO9WdvXoe7qeZ+ma9l0Zf5F6vYMXwVN2oipTjPAt1vfZGXpRrj6f37/tavo9fduH60GC7JiEgjUyYuS9QHDT171I21kep6A8om14mebWP5RIuF4YoDaVAF22Fb1Za5pO/wRqMWgCrtlZoms13etdrBCSAOgmuvy/tSvTAMa0KCu3PFBvSvj/krK3qywO2Pz9ZhrBo1Iw1rezdDNgQBaRZbUOwLQc9RxluB5w9L/VZwrOEAmn6O9bL9T5Zp1S/xVFdYw8sw8533sTkKwdevS4z70aEdxGVLMdD7itVt+Fz16mJAf97Oy2aROw6B24fEpNE/y+WGNv/MsOq/D3bf/ejrDlXp/k1M7tBmAKQDfLRlG6B1a7Mg1gNVHrAzyUlfvHSoF6Ux1wUZzv/SOdrxcPlMD9kub8r3sul83TWtXZAIHETB3ope3Z+shqNDHonA0iJZz6vqDG2Fao657dRZp28nSoZ6Kn2WjJUNtj1lULZVneBLQpApyH9e28vpt45/VJ2u++WxKhGf3qu5DtzQCLe827CDjGV1uxEj65emh632pTau72xj9KCcH9B94HV2nwbN1V//cDEqiRi3Qv0mebzje7lgSQAFjX+d6zRwL0vh3Aq6D97KdeARC5Jd+8j2u/wJtEwFVU6VpQMFaMsProu57zxXPeg3dqQhJOI3ynvkHSm5H3P17Vm6GC/zl91+0opr6GxUYsLqtdx/DPTl1a3Mzn7epNj+A24l009HMbkQCwECDb5P3a6440iYCT4Iql/tWuTZXC0PpUvj4PW0tlIkwBWN+yUc+Pq64Ov4RpAP387cF5/+N6ExCMvR9hgb2+De4mV1ffZqEjTEEJp+sRAtgi4HfkXMJuZHIYEeXxY3Rei55l7t0qtpqy+L6BdTHCFIk+c3xbec9fz89Y13uo6qDNj0g3c/+3YfS/CJj6ulP9DwmA9S0LqvsH7012Lqo8PrcEQJdS/SFsw2hJkRYp69OhzH3F5KmISDhtS3CZ8yJ2IQlBWwHOiem8vh+h/L/V5x7o+j0jEiTvBx85uxvZ7OpygN0JmLaxntsh7qu3naf0xIpIQmxL/0MCIFtN+f+yOZRRD3nU57xKW/DlYuONSNr3P6I0fqzv0rXxvh4xa8tyER30bXkB51zCHhVASQDc2bZnp98aDk3CY13b1ME/6VEFMPSUO4g0lfs1YnHebUm87dS7UwJgPUOX/7ciR7FzqQL4MJG5OREdylHKsYu0uNgaK8POO5zoYmxZSaO5fUcwi7FewBGjzynJFmKEXQ+Ytoj2eszOa98E2HrPX5MwiEhoj5MsbqoA9jskAaYymgqreDuJ/m6ze0rf6sOobTxX0XcR3Ii+1mRIAKxn2PL/lmkAXfxjIsexddnQqqrqTvD3K3aa6r/zR4HTZIRsjTdWwimohD/Xlewl3CI1wW3/zutY7XXMPtTrPn8xJa9jBtdNMLG/xvS2n9Je7bAtpjL9MqL/cRnwGavKeQrhZyQAVjVe+X/053050WkAkQv1fZzC3P80uhkxWjJ6OVRVVSepcfxpweJ+lylJ8CJVDeSq7yJT0SI66GMu5hhxvFmWsI+YpMlFSPJsxNGrTcw/jThH4y8WW1+Tg9u6nfg27XZzv92+TpVvvy8Obnduf2922pTWqohok8asZOjfnnWbRjVJtgFc3Vjl/63Ih+LLyc2xqc9Xvy2N5u1SY1hsaj522nVAZ2i5iK3YIkXcc6OMLKfdCiJG2sxhJ0LEs9NnEdV1Rcz5XffZiWjrNleqfHB7OtFtQ6GradzPcdODxmkfzvf2g9YQ2pkKRBUAq1uWAIgffW4SClEd812fBjCVBEBUZnBn9hllOGku/FaUMKfg/yzoeCHC9gS353unQZ3t1RMATYc5gsoViDOVCszt6e82W5lKBN4jAbCKZj/9ZWX0Q73gohILU50GEOGXEbdgekxIg5hG4mGU+23oCoCyLN+kqpadWkCHLbYtZZz1cZ7vXQTtw78uCW2Ylne71t8dvH043ztMvyMigbpTTAFYzbIR9CHK/1t1YuGroM+a3jSAGFP6TgIcxhRVCr9fluUQWwq9SmXWRv2Zmqhn52lxvjfUsxNVYttV1DmSAIAYU1p/KSoBcBhYbTRvX598OQmA1Yyz+v99zTz5j0FzTnY1ATBU8mVTxlwRle0W9dJ87UVJZqI6ry+D5pWOZZ3RQytmw7RMKZkW1T5sorope4UpACvYXPl/yzSALVCW5SZWaIYc2Q6PvnJdSHITgwCeV9g9Kvu2nATA4zZV/t+KfGHv+mKAkJNcR+gsKkZfdpJ4XExV0HS2LGO3qFDZlGZRvVztTHtmCsDjlgXNvw40d2UoX+k8w86QgQfWYT4+u8L7b3PyTb5MZxHG3iQAlnm8/P9Z+tkWz2aZux26gSfEFAAYQVVVF84zdCIBwDJG1WGx97t0bkwBWG4XG0PTAIBtde3KQUcHt5JnLGNUHRbbqQpqFQCLNAvm7WKwXCc1/jGB4wCm4e0WjQwawWRK6l1btiWo3kzl3/nei+Lg1nMLPOTHLTorO5VAlQBYbFdHyk0DAOadKquHTi6Kg9tjp26pFxJ3wAJnFgrdDFMAFtvlUnnTAOJFJVTMwWNs1q+AbnJeDRugL23ohkgAPGR3y/9bgsx4URlMc/AAtoN36eNsuQgwMRIAD9v1EfJnme/jOWllWeowMSZBDHSzy+/Rm6DP8T6D3RI5pUcF4oZYA+BhyxIAH4uD25ONHFWzLeGfgj7tS4sBTpY5k6yiXoDsdcCZkgwkNx+Cnp2XO3zeroLOkQQj7JJ6Uc/zvagvpP+xISoA7nu8/P9fmzmw2UNX/+5fgz7NSzlQ8CJqMqKMKaKTD9skLsF6vuddupzzAyyifdgQCYDPPXYzbnq1yqgERD0N4FnQZ9GIKpnUILKKsLaoLEv3HDmJ3AVnV5+dqKT2c1MOYedcBn0hAxAbIgHwuWUv87r8/5dNHVgSWYGg0x8rKiBTAcAqzMODbiIT+bv67EQmSbQvsFsiq6i0DxsgATCvyVIvGxXfXPl/K3YagO0AY4XtBFCWpQaRxwhioBvPzuMiz9GboQ4S2IjIAQjtwwZIAHzqsYB40+X/rahExFPTAEJF3h+HE/g+TFvk/fZ1WZbKdMnDwW09un0d9F2f7+Q6AAe3keva6ODDbrHu1ZaTAPjU1Mv/W6YBTJMOE6OpqqoOYt4H/j73HH1tUxIpsr0+CvysKYma5/ukON/TvsCuiE0QvrSY6vgkAFrbUP7fMg1gkqqq+hA4qlRPA9j1KoBcR5wj98UWxDAl29SJi03Y7uZCd9oXYJHIAQjtw8gkAO5sS/l/yzSAaYrsMB3v0ol5QK4Z36kmAF5ae2K6TNEIF/nsPNnRDuxZ4Ge9ttgX7JTI9mFXk6iTJQFwZ1vK/1umAUxTZIP4PIMqAHqoquoscPvJIoOk0zbTTkc6uP0QPoK1ax3Yg9urwKq2QvuSBUmefET2d59oH8YlAVDMyv+fbU35f2vbpwHsaNXBAAHZyVRG/sqyPJGQmKTQUbopXeOyLCOrJYak07udTgOPelpVAHUyIiYhEV0FMI21AOrjON87Ner4iYhkj/OZi/gE4XeTWgtgx9sGCYDGYzfc1Mr/W9s8DeCLkX/fmKI7lSeb/kJlWR7NGuei+Lksy7OMy5GnOAobeb8VU0k6pWO4yPx+Y1jRz84Pk+jANh3Xi9nP+V7fJFr0Odp80N1co/p7fTPr31mArBWxtdvLmENZok7cMBXR/dNpXNumTfiwy/eaBEBj2Qj4FMv/W5H7cH4V+Fm5i24Qv5NZI8sAAA5eSURBVNnkqGz63X+e+09f152msixz7DQ9mcAxfKKqqovgLPyT4FG/tbXB/2yLteZ+u5AEIFyzHeDb4I8922iAexf8v0w//QLcZpQvajeAYuPtS3N+Tufa8rqN+WdxvjeV8uNtqXpabKgqj6aq5SIlbpiG6AC53hFgs4NeTXt5kdqIb3Y1CSAB0Ix8L3tZT6/8/07ksdkNIEjaDSC6U/nzJhZoS8H/zw/8T8+DF9Gin+jOaz0VYCMvvZRY+nBvJOllxkmn7Iw89SO6s/k8jbyPnwT4NPhvPUnH0+f9Ed6+bKRT/fD5af0wkekJm0wARL3T48/jXVD2Ovyz6W6YJGo9FWAzg15NG3Bxb7CnTgJc7dqUAAmA7S3/rx+8XwOTAF8U53uSAHGGGE2oS6FH66AsCf5/O56xjoXlqqo6Da4CKFLlyaid9JTkuv/ybUk65WO8ICh+hLtIAea4SYAmQLpaENzWz9PfO08HaPb8jj5H446s3QWQi0rUbybSvmwyyPgY9DmxK7o3weCya8dmDdHf/Xn0JMD5Xj3V9a8L+h8vJzM9IYgEwPaW/7dyrwKYZEZuoCqAulH6a5qPP5i61DoFfsuC/2IqK7YqDf/NENfjm7Hm4JdleTwLUpZPswh9Abt3wkVNSxu70mOIjubLoDn4j2s6ru2UmUUu084HXQ3SvhTne8NPmbgb1VsWQJ6k0cxNe7nBkcaoAa+YFd3rZ6e+P5q+yOSm35E07cpPA5yOn0eZDtBMLTm7N9X1ITs16JV3AmC7y/9bEgDTdRS8I0DrzykoC+9YphHYqxXm2L1NSY4pUBZ+VwUQPUpXzK35MMgUlPpzy7K8mpXgLnczQBCS470zZJsZ1SaMO/IzXAe2nYM/TNK2CZAuUsf1sQCp3zE0VQDven3Gw75O5yi+fbkLIBeN6rVuprDY7pzN7CrSXOMo3cu4m4DsOPVFvo78igzmeKD+7nep/H6Yd3Vzj35Y4T6rE6gqAHbI9pb/t0wDmKyqqj4OOEreBmXHEaOYKQi7SCOwy0aRWvZrnaahqkPqe+Lv9T0SlQi4d8+tUtp5mJ4p+hky6RF1fV5uYAvI4wGm0RQp8Pxz6sTGTOFqAtu6M/rvFedE/5SmOvR1OFAn/3maotB3rYJGc37WCSCjRv+jAuhNbicZmUT+ea3k1911+5ASwkb9t0Xz/AyVuH2ZFuo8DauoqgP/870Pa1SXTGeL1yC5JwC2vfy/lXsVwGRVVXUy0KhJkRqt+iX5f3XJfr0+wDrJgHpBtXo6QRp9/fsai+v8OKHRf+ZUVVVfy+8HPCevUyLgKt07a72M0z1XJ60+rHnPvauqypoTE5fuvyhrj8im6Utn6f5cLzE6bAe2SJ3Yv846nXVZ67ojWk1wdDRLJDSB/6orob8PS9gOf45ep0TAVfquq7cvzajxYRrx//caAeR1cXAbldCOei++7pQIqRNM53sfe86djm5n/5zu+aPPvlNzzfZnQf/dfb3KdbsZKFlHHwe3ZwP2d4vU5v07TRs6XDsZ0NxrJ7NnpAn8Vxnsqv0YlECdlP/ctS+0smake9vL/1sSANN2mEYiVm1suvim7RCWZfk+dUQWNVj7aRSwS3b9fVVVRv8nrE46pVH6IUsnX6ay43o6yk26164WjAC/SD9dV2++Hr0knD4ug1bq/rosy5OqqlYaeUmLlp7MtWsna983dQn0+d6PK0xH6eP5rKy1KW197Nl5mtrqru31zewcRM5trzv553s/pe8wlN/al7lztGh0/VVqX7ouEBe5sG5kkHA2C1hWCTyaQOhkrs2vR96LjiXLq8yFXtfz3z6zPq7+jtI1H/I5pZsxFmz8+rd7/XzvOvV3l7UPT3u8ky4DE4STklcC4Hzvi6Ions29VJepy+HrvfF/SdUAUy89/SV9t76aaQAHt9uSAPliAsewVF22nFbvX7S6ebR2/+foAPBGILY1xlw1+Ul6uQ6xPVN9z71R+r9VzgLvhe9SlcnRQ1VHaZT/TRrhvp9grRewrNvfdZMAxymgGmOv8SGfnWIWKA0xcnVwe5QqGMbYkm3IcxQ7sld/VhOQRCT72+0bjxYG8s19epTa+/t9i5PZqPq6369eD+N8LyqJN4RvZ+ejmSqwLaKmM01/0do6VrrbtWGM/u7z9DPE/Xo9yJaWE1FWVbV736ppFOeD/adBD+AvKUvf/tn83808/OHcJS4W/Rmt/W5th+vDb9+/z3e9+x4v5n6ifEjX5Zd0nJObvpH2MB+rURzCt2mhuc7SyHQ7orUf1FG6TOe1/vkQOT0hBRiv5qomIpIq71OQVB/v1VDBbTr2bd86qfc9d9+9a7of1HF4n3YoqK9n2EJa23SsrRSw/zv6c9Nz3o6Ut+dllfPx49pVS8v3i98W3xcHt8MtbLf95+hdcXA7xH71JwNUR7RbFLbB/It0/z927m9mf2/d3R+aAO6xXYA24dvfkiExx3iZ3sVXwQsgts9H23a/CX5OLucqh9ZP8ozhbtvNbe3v3syu3Q6W/rd2JwHQrOh/uMER4bPQG+VuDtfYCyGtog6u60TA3xYG2p8G+8/mkjFjH+d8UmDj89a3OAmwViB2L3BZtbMS5eaTl2MT6Dz6bD4Q7L8aeNpG63ruWEOTAlueBIhIOG3qmr6/d/892rncpmN9TFrccSojiL/vtDbBdge4b4uD2+Grtbb3HL1Pnfv45GszADVEAqyLuny526KKzQJpY7Q/q/r2k0qIZj2Bvwf/jvfz7+GV+/TNNX9172fscze9pMD2JgF2PvgvdiwB8GLD5ckXoRnE7ShvOn0wqN78tVhsAnN5tjAJsG7wP8SLubeqqsotOuY/RI3ObmES4CaVfEdUm0zmmm7T/bfsWFcxoe/zfVqItbtmtf0xpgNEGXbk/74mCXC6Rdu1DRf8t6Zxz3Qb/W8NE2B39e1n0yDGOr6D2+VtYdNXn+ZaBI8d+xi2LwmQRfBf2AUAxpdGo16kjsjUhZdgM65UTbA/GxWcvtnL1z233VLyaoh99dfxtnfwX8w60YezueLTd5MCpXH3s68D6aaUfhvO0bvBg//G0UDbJa6qDWK6Vz02A1qbfobr7/HHBWsg7HyAthOaQHpb+rvvZ8eaQfBfSADAZtRBWVVVrybcabpJo9ACsR2Q7rfDWWdqsx3TZeoSxhfBW8mxOccb7PS9XXvxv2WayrE/THjrsXZUe3Pt9fTP0Y+zRMUYCzoPv13iMpEjmJt8ht+nCoaHtyWc/sLctJok4ZT7u8Us2VUfY0b3lQQAbFBanOr3KfiZircpEAtfIIyN329nKRs/pWqAm1Rpsm+1/90xV3kydgDxU2jw32pGRKfYif0xdVw3nzib5jm6niUmxp7+1wSu3476O6PLl5tgaBPPcHtPb3zdJgI1z+DU+rtt+7DSdrO7RAIANqwe8ayDnzR6ssmG8TKN+h8KxHbXXDXApu+3mxQovFBpspvmkgBj3GezcuGqqobryDUjWXUn9ncTSKK9nR3H1Paons45ukmB5IvwFd5X1VRkfDtS1dW7QcqX75IA70I/92GXa97TUwokWUV9fzYLU/5hw9MCrtOUqc21DxsmAQATUY+4zyUCxuw4vUuB/75R/3zM3W9tR32sqQHXc4H/sWTTbksJp/10zYe4x+YTSQ+XC0erRyabtQF+l373WGXvN2le9u9mv3/KI6SbO0fXs4UQm2B488mRJgnwasBgtR3BHG56w906D98P9Axfpu/Qb90CtkcddDfTAv4wUnKp9X4u8M964GF3dgFgOu62AJyeLXq5pNXb36Sf/eBVVNu9wM8i980vPt3ObFKWJTcmeMxhWwGuoyzLN3P3XOT9dp32Wz4bK8k0tWu6TfffUNcofc+jND+67zZZbRt2Ookk0vnem7k9vyO3ALtpn52F86G3xXDn6HruHE03id2sXH8YtENAHTSdjP59m10fIp7h9pqd9NipYJ3dFm4eWDjwQ/qZV/+du/bksfPb7Ho1xe26Hz/2KWnuqyH7uxdp5zJrDCUSALAl0vaB8/vqv1jxBXyZXmjh+8yzu9L91t5n9X33dMWtBN+n++0ida4uopNMbL+59qxt0x67ty7b+2ny99Sn+4K3+7C/XuFfvp9rq6ezn/cQ+p+j39qXrRs1boKd9t5vz8GygOd67t6/mkwiqNni7c3cM7ysP9I+v1fpmvW/r5uEyv7CQN5Cgdurubf69nfbe8198AAJAAAAAMiANQAAAAAgAxIAAAAAkAEJAAAAAMiABAAAAABkQAIAAAAAMiABAAAAABmQAAAAAIAMSAAAAABABiQAAAAAIAMSAAAAAJABCQAAAADIgAQAAAAAZEACAAAAADIgAQAAAAAZkAAAAACADEgAAAAAQAYkAAAAACADEgAAAACQAQkAAAAAyIAEAAAAAGRAAgAAAAAyIAEAAAAAGZAAAAAAgAxIAAAAAEAGJAAAAAAgAxIAAAAAkAEJAAAAAMiABAAAAABkQAIAAAAAMiABAAAAABmQAAAAAIAMSAAAAABABiQAAAAAIAMSAAAAAJABCQAAAADIgAQAAAAAZEACAAAAADIgAQAAAAAZkAAAAACADEgAAAAAQAYkAAAAACADEgAAAACQAQkAAAAAyIAEAAAAAGRAAgAAAAAyIAEAAAAAGZAAAAAAgAxIAAAAAEAGJAAAAAAgAxIAAAAAkAEJAAAAAMiABAAAAABkQAIAAAAAMiABAAAAABmQAAAAAIAMSAAAAABABiQAAAAAIAMSAAAAAJABCQAAAADIgAQAAAAAZEACAAAAADIgAQAAAAAZkAAAAACADEgAAAAAQAYkAAAAACADEgAAAACQAQkAAAAAyIAEAAAAAGRAAgAAAAAyIAEAAAAAGZAAAAAAgAxIAAAAAEAGJAAAAAAgAxIAAAAAsOuKovj/pKNEpacuySMAAAAASUVORK5CYII=",e.appendChild(t),t.onload=function(){e.style.display="block"};var v=document.createElement("div");v.id="progress-bar-container",e.appendChild(v);var n=document.createElement("div");n.id="progress-bar",v.appendChild(n)}(),A.on("preload:end",(function(){A.off("preload:progress")})),A.on("preload:progress",(function(A){var e=document.getElementById("progress-bar");e&&(A=Math.min(1,Math.max(0,A)),e.style.width=100*A+"%")})),A.on("start",(function(){var A=document.getElementById("application-splash-wrapper");A.parentElement.removeChild(A)}))}));var EvVr=pc.createScript("evVr");EvVr.attributes.add("targetPosition",{type:"entity",title:"targetPosition"}),EvVr.prototype.initialize=function(){this.entity.element.on(pc.EVENT_MOUSEDOWN,this.onMouseDown,this),this.entity.element.on(pc.EVENT_MOUSEUP,this.onMouseUp,this),this.app.touch&&(this.entity.element.on(pc.EVENT_TOUCHSTART,this.onMouseDown,this),this.entity.element.on(pc.EVENT_TOUCHMOVE,this.onMouseMove,this),this.entity.element.on(pc.EVENT_TOUCHEND,this.onMouseUp,this)),this.entity.button.on("click",(function(){this.doSomethingVR()}),this)},EvVr.prototype.onMouseDown=function(t){t.stopPropagation()},EvVr.prototype.onMouseUp=function(t){this.doSomething(),t.stopPropagation()},EvVr.prototype.onMouseMove=function(t){t.stopPropagation()},EvVr.prototype.doSomething=function(){var t=this.app,o=this.targetPosition.getPosition();t.root.findByName("WalkPlayer").enabled=!1,t.root.findByName("WalkPlayer").setPosition(o.x,o.y,o.z),t.root.findByName("WalkPlayer").enabled=!0},EvVr.prototype.doSomethingVR=function(){var t=this.app,o=this.targetPosition.getPosition();t.root.findByName("Camera Offset").setPosition(o.x,o.y-.875,o.z)};var AutoExposureVr=pc.createScript("autoExposureVr");AutoExposureVr.attributes.add("targetExposure",{type:"number",default:2}),AutoExposureVr.prototype.initialize=function(){this.entity.on("object:interact",this._onInteract,this),this.entity.on("object:onhover",this._onHover,this),this._state=0,this._time=0},AutoExposureVr.prototype.update=function(t){switch(this._state){case 0:break;case 1:if(this._time+=t,this.alpha<1){this.alpha+=t;var e=pc.math.lerp(this.start,this.end,this.alpha);this.app.scene.exposure=e}else this._state=0}},AutoExposureVr.prototype._onInteract=function(t){this._isIdle()&&(this._time=0,this._state=1)},AutoExposureVr.prototype._onHover=function(){this._isIdle()&&(this.alpha=0,this.value=this.app.scene.exposure,this.start=this.app.scene.exposure,this.end=this.targetExposure)},AutoExposureVr.prototype._isIdle=function(){return 0==this._state};document.addEventListener("contextmenu",(function(e){e.preventDefault()}));var TeleportCamera=pc.createScript("teleportCamera");TeleportCamera.prototype.initialize=function(){this.app.on("teleport:to",(function(t){this.entity.setPosition(t)}),this)};var Controllers=pc.createScript("controllers");Controllers.attributes.add("controllerTemplate",{type:"asset",assetType:"template",title:"Controller Template"}),Controllers.prototype.initialize=function(){this.controllerAssets=this.app.assets.findByTag("controller"),this.controllerAssetsIndex={};for(var e=0;e<this.controllerAssets.length;e++){var t=this.controllerAssets[e].name.replace(/\.[a-z]+$/i,"");this.controllerAssetsIndex[t]=this.controllerAssets[e]}this.app.xr.input.on("add",(function(e){for(var t=this.controllerTemplate.resource.instantiate(),r=null,s=0;s<e.profiles.length;s++){var l=e.profiles[s]+"-"+e.handedness;if(r=this.controllerAssetsIndex[l])break}r||(r=this.controllerAssetsIndex["generic-trigger-"+(e.handedness||"none")]),t.reparent(this.app.root),t.script.controller.setInputSource(e,r),t.enabled=!0}),this)};var Teleport=pc.createScript("teleport");Teleport.prototype.initialize=function(){this.app.on("teleport:show",(function(){this.entity.enabled=!0}),this),this.app.on("teleport:hide",(function(){this.entity.enabled=!1}),this),this.app.on("teleport:transform",(function(t,e){this.entity.setPosition(t),this.entity.setRotation(e)}),this)};var AutoExposure=pc.createScript("autoExposure");AutoExposure.attributes.add("targetExposure",{type:"number",default:2});var LERP_SPEED=1;this.oncollision=0,AutoExposure.prototype.initialize=function(){this.entity.collision.on("triggerenter",this.onTriggerEnter,this)},AutoExposure.prototype.onTriggerEnter=function(){this.alpha=0,this.oncollision=1,this.value=this.app.scene.exposure,this.start=this.app.scene.exposure,this.end=this.targetExposure},AutoExposure.prototype.update=function(t){if(1==this.oncollision)if(this.alpha+=LERP_SPEED*t,this.alpha<1){var e=pc.math.lerp(this.start,this.end,this.alpha);this.app.scene.exposure=e}else this.oncollision=0};var OrbitCamera=pc.createScript("orbitCamera");OrbitCamera.attributes.add("distanceMax",{type:"number",default:0,title:"Distance Max",description:"Setting this at 0 will give an infinite distance limit"}),OrbitCamera.attributes.add("distanceMin",{type:"number",default:0,title:"Distance Min"}),OrbitCamera.attributes.add("pitchAngleMax",{type:"number",default:90,title:"Pitch Angle Max (degrees)"}),OrbitCamera.attributes.add("pitchAngleMin",{type:"number",default:-90,title:"Pitch Angle Min (degrees)"}),OrbitCamera.attributes.add("inertiaFactor",{type:"number",default:0,title:"Inertia Factor",description:"Higher value means that the camera will continue moving after the user has stopped dragging. 0 is fully responsive."}),OrbitCamera.attributes.add("focusEntity",{type:"entity",title:"Focus Entity",description:"Entity for the camera to focus on. If blank, then the camera will use the whole scene"}),OrbitCamera.attributes.add("frameOnStart",{type:"boolean",default:!0,title:"Frame on Start",description:'Frames the entity or scene at the start of the application."'}),Object.defineProperty(OrbitCamera.prototype,"distance",{get:function(){return this._targetDistance},set:function(t){this._targetDistance=this._clampDistance(t)}}),Object.defineProperty(OrbitCamera.prototype,"pitch",{get:function(){return this._targetPitch},set:function(t){this._targetPitch=this._clampPitchAngle(t)}}),Object.defineProperty(OrbitCamera.prototype,"yaw",{get:function(){return this._targetYaw},set:function(t){this._targetYaw=t;var i=(this._targetYaw-this._yaw)%360;this._targetYaw=i>180?this._yaw-(360-i):i<-180?this._yaw+(360+i):this._yaw+i}}),Object.defineProperty(OrbitCamera.prototype,"pivotPoint",{get:function(){return this._pivotPoint},set:function(t){this._pivotPoint.copy(t)}}),OrbitCamera.prototype.focus=function(t){this._buildAabb(t,0);var i=this._modelsAabb.halfExtents,e=Math.max(i.x,Math.max(i.y,i.z));e/=Math.tan(.5*this.entity.camera.fov*pc.math.DEG_TO_RAD),e*=2,this.distance=e,this._removeInertia(),this._pivotPoint.copy(this._modelsAabb.center)},OrbitCamera.distanceBetween=new pc.Vec3,OrbitCamera.prototype.resetAndLookAtPoint=function(t,i){this.pivotPoint.copy(i),this.entity.setPosition(t),this.entity.lookAt(i);var e=OrbitCamera.distanceBetween;e.sub2(i,t),this.distance=e.length(),this.pivotPoint.copy(i);var a=this.entity.getRotation();this.yaw=this._calcYaw(a),this.pitch=this._calcPitch(a,this.yaw),this._removeInertia(),this._updatePosition()},OrbitCamera.prototype.resetAndLookAtEntity=function(t,i){this._buildAabb(i,0),this.resetAndLookAtPoint(t,this._modelsAabb.center)},OrbitCamera.prototype.reset=function(t,i,e){this.pitch=i,this.yaw=t,this.distance=e,this._removeInertia()},OrbitCamera.prototype.initialize=function(){var t=this,onWindowResize=function(){t._checkAspectRatio()};window.addEventListener("resize",onWindowResize,!1),this._checkAspectRatio(),this._modelsAabb=new pc.BoundingBox,this._buildAabb(this.focusEntity||this.app.root,0),this.entity.lookAt(this._modelsAabb.center),this._pivotPoint=new pc.Vec3,this._pivotPoint.copy(this._modelsAabb.center);var i=this.entity.getRotation();if(this._yaw=this._calcYaw(i),this._pitch=this._clampPitchAngle(this._calcPitch(i,this._yaw)),this.entity.setLocalEulerAngles(this._pitch,this._yaw,0),this._distance=0,this._targetYaw=this._yaw,this._targetPitch=this._pitch,this.frameOnStart)this.focus(this.focusEntity||this.app.root);else{var e=new pc.Vec3;e.sub2(this.entity.getPosition(),this._pivotPoint),this._distance=this._clampDistance(e.length())}this._targetDistance=this._distance,this.on("attr:distanceMin",(function(t,i){this._targetDistance=this._clampDistance(this._distance)})),this.on("attr:distanceMax",(function(t,i){this._targetDistance=this._clampDistance(this._distance)})),this.on("attr:pitchAngleMin",(function(t,i){this._targetPitch=this._clampPitchAngle(this._pitch)})),this.on("attr:pitchAngleMax",(function(t,i){this._targetPitch=this._clampPitchAngle(this._pitch)})),this.on("attr:focusEntity",(function(t,i){this.frameOnStart?this.focus(t||this.app.root):this.resetAndLookAtEntity(this.entity.getPosition(),t||this.app.root)})),this.on("attr:frameOnStart",(function(t,i){t&&this.focus(this.focusEntity||this.app.root)})),this.on("destroy",(function(){window.removeEventListener("resize",onWindowResize,!1)}))},OrbitCamera.prototype.update=function(t){var i=0===this.inertiaFactor?1:Math.min(t/this.inertiaFactor,1);this._distance=pc.math.lerp(this._distance,this._targetDistance,i),this._yaw=pc.math.lerp(this._yaw,this._targetYaw,i),this._pitch=pc.math.lerp(this._pitch,this._targetPitch,i),this._updatePosition()},OrbitCamera.prototype._updatePosition=function(){this.entity.setLocalPosition(0,0,0),this.entity.setLocalEulerAngles(this._pitch,this._yaw,0);var t=this.entity.getPosition();t.copy(this.entity.forward),t.scale(-this._distance),t.add(this.pivotPoint),this.entity.setPosition(t)},OrbitCamera.prototype._removeInertia=function(){this._yaw=this._targetYaw,this._pitch=this._targetPitch,this._distance=this._targetDistance},OrbitCamera.prototype._checkAspectRatio=function(){var t=this.app.graphicsDevice.height,i=this.app.graphicsDevice.width;this.entity.camera.horizontalFov=t>i},OrbitCamera.prototype._buildAabb=function(t,i){var e=0;if(t.model){var a=t.model.meshInstances;for(e=0;e<a.length;e++)0===i?this._modelsAabb.copy(a[e].aabb):this._modelsAabb.add(a[e].aabb),i+=1}for(e=0;e<t.children.length;++e)i+=this._buildAabb(t.children[e],i);return i},OrbitCamera.prototype._calcYaw=function(t){var i=new pc.Vec3;return t.transformVector(pc.Vec3.FORWARD,i),Math.atan2(-i.x,-i.z)*pc.math.RAD_TO_DEG},OrbitCamera.prototype._clampDistance=function(t){return this.distanceMax>0?pc.math.clamp(t,this.distanceMin,this.distanceMax):Math.max(t,this.distanceMin)},OrbitCamera.prototype._clampPitchAngle=function(t){return pc.math.clamp(t,-this.pitchAngleMax,-this.pitchAngleMin)},OrbitCamera.quatWithoutYaw=new pc.Quat,OrbitCamera.yawOffset=new pc.Quat,OrbitCamera.prototype._calcPitch=function(t,i){var e=OrbitCamera.quatWithoutYaw,a=OrbitCamera.yawOffset;a.setFromEulerAngles(0,-i,0),e.mul2(a,t);var s=new pc.Vec3;return e.transformVector(pc.Vec3.FORWARD,s),Math.atan2(s.y,-s.z)*pc.math.RAD_TO_DEG};var Screen=pc.createScript("screen");Screen.attributes.add("landscapeOrthoheight",{type:"number",default:10}),Screen.attributes.add("portraitOrthoheight",{type:"number",default:20}),Screen.attributes.add("landscapeAngle",{type:"number",default:0}),Screen.attributes.add("portraitAngle",{type:"number",default:0}),Screen.prototype.initialize=function(){var a=window.innerWidth,e=window.innerHeight;a>e?(this.app.root.findByName("MapCameras").setLocalEulerAngles(0,this.landscapeAngle,0),this.app.root.findByName("PlayerMapCamera").camera.orthoHeight=this.landscapeOrthoheight,this.app.root.findByName("PlanCamera").camera.orthoHeight=this.landscapeOrthoheight,this.app.root.findByName("BackgroundCamera").camera.orthoHeight=this.landscapeOrthoheight):a===e||(this.app.root.findByName("MapCameras").setLocalEulerAngles(0,this.portraitAngle,0),this.app.root.findByName("PlayerMapCamera").camera.orthoHeight=this.portraitOrthoheight,this.app.root.findByName("PlanCamera").camera.orthoHeight=this.portraitOrthoheight,this.app.root.findByName("BackgroundCamera").camera.orthoHeight=this.portraitOrthoheight)},Screen.prototype.update=function(a){var e=this;function calculateDimensions(){var a=window.innerWidth,t=window.innerHeight;a>t?(e.app.root.findByName("MapCameras").setLocalEulerAngles(0,e.landscapeAngle,0),e.app.root.findByName("PlayerMapCamera").camera.orthoHeight=e.landscapeOrthoheight,e.app.root.findByName("PlanCamera").camera.orthoHeight=e.landscapeOrthoheight,e.app.root.findByName("BackgroundCamera").camera.orthoHeight=e.landscapeOrthoheight):a===t||(e.app.root.findByName("MapCameras").setLocalEulerAngles(0,e.portraitAngle,0),e.app.root.findByName("PlayerMapCamera").camera.orthoHeight=e.portraitOrthoheight,e.app.root.findByName("PlanCamera").camera.orthoHeight=e.portraitOrthoheight,e.app.root.findByName("BackgroundCamera").camera.orthoHeight=e.portraitOrthoheight)}window.addEventListener("orientationchange",calculateDimensions,!1),window.addEventListener("resize",calculateDimensions,!1)};var MouseInputFly=pc.createScript("MouseInputFly");MouseInputFly.attributes.add("orbitSensitivity",{type:"number",default:.3,title:"Orbit Sensitivity",description:"How fast the camera moves around the orbit. Higher is faster"}),MouseInputFly.attributes.add("distanceSensitivity",{type:"number",default:.15,title:"Distance Sensitivity",description:"How fast the camera moves in and out. Higher is faster"}),MouseInputFly.prototype.initialize=function(){if(this.orbitCamera=this.entity.script.orbitCamera,this.orbitCamera){var t=this,onMouseOut=function(o){t.onMouseOut(o)};this.app.mouse.on(pc.EVENT_MOUSEDOWN,this.onMouseDown,this),this.app.mouse.on(pc.EVENT_MOUSEUP,this.onMouseUp,this),this.app.mouse.on(pc.EVENT_MOUSEMOVE,this.onMouseMove,this),this.app.mouse.on(pc.EVENT_MOUSEWHEEL,this.onMouseWheel,this),window.addEventListener("mouseout",onMouseOut,!1),this.on("destroy",(function(){this.app.mouse.off(pc.EVENT_MOUSEDOWN,this.onMouseDown,this),this.app.mouse.off(pc.EVENT_MOUSEUP,this.onMouseUp,this),this.app.mouse.off(pc.EVENT_MOUSEMOVE,this.onMouseMove,this),this.app.mouse.off(pc.EVENT_MOUSEWHEEL,this.onMouseWheel,this),window.removeEventListener("mouseout",onMouseOut,!1)}))}this.app.mouse.disableContextMenu(),this.lookButtonDown=!1,this.panButtonDown=!1,this.lastPoint=new pc.Vec2},MouseInputFly.fromWorldPoint=new pc.Vec3,MouseInputFly.toWorldPoint=new pc.Vec3,MouseInputFly.worldDiff=new pc.Vec3,MouseInputFly.prototype.pan=function(t){var o=MouseInputFly.fromWorldPoint,e=MouseInputFly.toWorldPoint,i=MouseInputFly.worldDiff,s=this.entity.camera,n=this.orbitCamera.distance;s.screenToWorld(t.x,t.y,n,o),s.screenToWorld(this.lastPoint.x,this.lastPoint.y,n,e),i.sub2(e,o),this.orbitCamera.pivotPoint.add(i)},MouseInputFly.prototype.onMouseDown=function(t){switch(t.button){case pc.MOUSEBUTTON_LEFT:this.lookButtonDown=!0;break;case pc.MOUSEBUTTON_MIDDLE:case pc.MOUSEBUTTON_RIGHT:this.panButtonDown=!0}},MouseInputFly.prototype.onMouseUp=function(t){switch(t.button){case pc.MOUSEBUTTON_LEFT:this.lookButtonDown=!1;break;case pc.MOUSEBUTTON_MIDDLE:case pc.MOUSEBUTTON_RIGHT:this.panButtonDown=!1}},MouseInputFly.prototype.onMouseMove=function(t){pc.app.mouse;this.lookButtonDown?(this.orbitCamera.pitch-=t.dy*this.orbitSensitivity,this.orbitCamera.yaw-=t.dx*this.orbitSensitivity):this.panButtonDown&&this.pan(t),this.lastPoint.set(t.x,t.y)},MouseInputFly.prototype.onMouseWheel=function(t){this.orbitCamera.distance-=t.wheel*this.distanceSensitivity*(.1*this.orbitCamera.distance),t.event.preventDefault()},MouseInputFly.prototype.onMouseOut=function(t){this.lookButtonDown=!1,this.panButtonDown=!1};!function(){var t=new pc.Vec3;pc.RigidBodyComponentSystem.prototype.raycastFirstByTag=function(n,r,a){for(var e=Number.MAX_VALUE,i=null,s=this.app.systems.rigidbody.raycastAll(n,r),o=0;o<s.length;++o){var y=s[o];if(y.entity.tags.has(a)){t.sub2(y.point,n);var p=t.lengthSq();p<e&&(e=p,i=y)}}return i}}();var CharacterController=pc.createScript("characterController");CharacterController.attributes.add("speed",{type:"number",default:5}),CharacterController.attributes.add("jumpImpulse",{type:"number",default:400}),CharacterController.prototype.initialize=function(){this.oriloc=this.entity.getPosition(),this.groundCheckRay=new pc.Vec3(0,-1.1,0),this.rayEnd=new pc.Vec3,this.groundNormal=new pc.Vec3,this.onGround=!0,this.jumping=!1},CharacterController.prototype.move=function(t){if(this.onGround&&!this.jumping){var e=new pc.Vec3,i=t.length();i>0&&(e.cross(this.groundNormal,t).cross(e,this.groundNormal),e.normalize().scale(i*this.speed)),this.entity.rigidbody.linearVelocity=e}},CharacterController.prototype.jump=function(){this.onGround&&!this.jumping&&(this.entity.rigidbody.applyImpulse(0,this.jumpImpulse,0),this.onGround=!1,this.jumping=!0,setTimeout(function(){this.jumping=!1}.bind(this),500))},CharacterController.prototype.update=function(t){var e=this.entity.getPosition();this.rayEnd.add2(e,this.groundCheckRay);var i=this.app.systems.rigidbody.raycastFirstByTag(e,this.rayEnd,"Physical");this.onGround=!!i,i&&this.groundNormal.copy(i.normal)};var FirstPersonCamera=pc.createScript("firstPersonCamera");FirstPersonCamera.attributes.add("camera",{title:"Camera",description:"The camera controlled by this first person view. It should be a child of the entity to which this script is assigned. If no camera is assigned, the script will create one for you.",type:"entity"}),FirstPersonCamera.prototype.initialize=function(){window.addEventListener("orientationchange",calculateDimensions,!1),window.addEventListener("resize",calculateDimensions,!1);const t=this;function calculateDimensions(){t.w=window.innerWidth,t.h=window.innerHeight}calculateDimensions();var e=this.app;this.camera||(this.camera=this.entity.findByName("Camera"),this.camera||(this.camera=new pc.Entity("FPS Camera"),this.camera.addComponent("camera"))),this.x=new pc.Vec3,this.z=new pc.Vec3,this.heading=new pc.Vec3,this.magnitude=new pc.Vec2,this.azimuth=0,this.elevation=0;var i=this.camera.forward.clone();i.y=0,i.normalize(),this.azimuth=Math.atan2(-i.x,-i.z)*(180/Math.PI),(new pc.Mat4).setFromAxisAngle(pc.Vec3.UP,-this.azimuth).transformVector(this.camera.forward,i),this.elevation=Math.atan(i.y,i.z)*(180/Math.PI),this.forward=0,this.strafe=0,this.jump=!1,this.cnt=0,e.on("firstperson:forward",(function(t){this.forward=t}),this),e.on("firstperson:strafe",(function(t){this.strafe=t}),this),e.on("firstperson:look",(function(t,e){this.azimuth+=t,this.elevation+=e,this.elevation=pc.math.clamp(this.elevation,-90,90)}),this),e.on("firstperson:jump",(function(){this.jump=!0}),this)},FirstPersonCamera.prototype.postUpdate=function(t){this.camera.setEulerAngles(this.elevation,this.azimuth,0),this.camera.vectorloc=this.camera.getEulerAngles(),this.camera.from=this.camera.camera.screenToWorld(this.w/2,this.h/2,this.camera.camera.nearClip),this.camera.to=this.camera.camera.screenToWorld(this.w/2,this.h/2,this.camera.camera.farClip),this.z.copy(this.camera.forward),this.z.y=0,this.z.normalize(),this.x.copy(this.camera.right),this.x.y=0,this.x.normalize(),this.heading.set(0,0,0),0!==this.forward&&(this.z.scale(this.forward),this.heading.add(this.z)),0!==this.strafe&&(this.x.scale(this.strafe),this.heading.add(this.x)),this.heading.length()>1e-4&&(this.magnitude.set(this.forward,this.strafe),this.heading.normalize().scale(this.magnitude.length())),this.jump&&(this.entity.script.characterController.jump(),this.jump=!1),this.entity.script.characterController.move(this.heading);var e=this.camera.getPosition();this.app.fire("cameramove",e)};var KeyboardInput=pc.createScript("keyboardInput");KeyboardInput.prototype.initialize=function(){var t=this.app,updateMovement=function(e,i){switch(e){case 38:case 87:t.fire("firstperson:forward",i);break;case 40:case 83:t.fire("firstperson:forward",-i);break;case 37:case 65:t.fire("firstperson:strafe",-i);break;case 39:case 68:t.fire("firstperson:strafe",i)}},keyDown=function(e){e.repeat||(updateMovement(e.keyCode,1),32===e.keyCode&&t.fire("firstperson:jump"))},keyUp=function(t){updateMovement(t.keyCode,0)},addEventListeners=function(){window.addEventListener("keydown",keyDown,!0),window.addEventListener("keyup",keyUp,!0)};this.on("enable",addEventListeners),this.on("disable",(function(){window.addEventListener("keydown",keyDown,!0),window.addEventListener("keyup",keyUp,!0)})),addEventListeners()};var MouseInput=pc.createScript("mouseInput");function applyRadialDeadZone(t,e,i,s){var a=t.length();if(a>i){var r=1-s-i,n=Math.min(1,(a-i)/r)/a;e.copy(t).scale(n)}else e.set(0,0)}MouseInput.attributes.add("camera",{type:"entity",description:"Optional, assign a camera entity, otherwise one is created"}),MouseInput.attributes.add("lookSpeed",{type:"number",default:.25,description:"Adjusts the sensitivity of looking"}),MouseInput.prototype.initialize=function(){this.force=new pc.Vec3,this.eulers=new pc.Vec3,this.on("enable",this.onEnable,this),this.on("disable",this.onDisable,this),this.onEnable()},MouseInput.prototype.onEnable=function(){this.app.mouse.on("mousemove",this._onMouseMove,this)},MouseInput.prototype.onDisable=function(){this.app.mouse.off("mousemove",this._onMouseMove,this)},MouseInput.prototype.update=function(t){this.camera.setLocalEulerAngles(this.eulers.y,this.eulers.x,0)},MouseInput.prototype._onMouseMove=function(t){if(pc.Mouse.isPointerLocked()||t.buttons[0]){var e=t.dx,i=t.dy;this.app.fire("firstperson:look",-e/5,-i/5)}};var TouchInput=pc.createScript("touchInput");TouchInput.attributes.add("deadZone",{title:"Dead Zone",description:"Radial thickness of inner dead zone of the virtual joysticks. This dead zone ensures the virtual joysticks report a value of 0 even if a touch deviates a small amount from the initial touch.",type:"number",min:0,max:.4,default:.3}),TouchInput.attributes.add("turnSpeed",{title:"Turn Speed",description:"Maximum turn speed in degrees per second",type:"number",default:150}),TouchInput.attributes.add("radius",{title:"Radius",description:"The radius of the virtual joystick in CSS pixels.",type:"number",default:50}),TouchInput.attributes.add("doubleTapInterval",{title:"Double Tap Interval",description:"The time in milliseconds between two taps of the right virtual joystick for a double tap to register. A double tap will trigger a jump.",type:"number",default:300}),TouchInput.prototype.initialize=function(){var t=this.app,e=t.graphicsDevice,i=e.canvas;this.remappedPos=new pc.Vec2,this.leftStick={identifier:-1,center:new pc.Vec2,pos:new pc.Vec2},this.rightStick={identifier:-1,center:new pc.Vec2,pos:new pc.Vec2},this.lastRightTap=0;var s=function(s){s.preventDefault();for(var a=e.width/i.clientWidth,r=e.height/i.clientHeight,n=s.changedTouches,o=0;o<n.length;o++){var h=n[o];if(h.pageX<=i.clientWidth/2&&-1===this.leftStick.identifier)this.leftStick.identifier=h.identifier,this.leftStick.center.set(h.pageX,h.pageY),this.leftStick.pos.set(0,0),t.fire("leftjoystick:enable",h.pageX*a,h.pageY*r);else if(h.pageX>i.clientWidth/2&&-1===this.rightStick.identifier){this.rightStick.identifier=h.identifier,this.rightStick.center.set(h.pageX,h.pageY),this.rightStick.pos.set(0,0),t.fire("rightjoystick:enable",h.pageX*a,h.pageY*r);var p=Date.now();p-this.lastRightTap<this.doubleTapInterval&&t.fire("firstperson:jump"),this.lastRightTap=p}}}.bind(this),a=function(s){s.preventDefault();for(var a=e.width/i.clientWidth,r=e.height/i.clientHeight,n=s.changedTouches,o=0;o<n.length;o++){var h=n[o];h.identifier===this.leftStick.identifier?(this.leftStick.pos.set(h.pageX,h.pageY),this.leftStick.pos.sub(this.leftStick.center),this.leftStick.pos.scale(1/this.radius),t.fire("leftjoystick:move",h.pageX*a,h.pageY*r)):h.identifier===this.rightStick.identifier&&(this.rightStick.pos.set(h.pageX,h.pageY),this.rightStick.pos.sub(this.rightStick.center),this.rightStick.pos.scale(1/this.radius),t.fire("rightjoystick:move",h.pageX*a,h.pageY*r))}}.bind(this),r=function(e){e.preventDefault();for(var i=e.changedTouches,s=0;s<i.length;s++){var a=i[s];a.identifier===this.leftStick.identifier?(this.leftStick.identifier=-1,t.fire("firstperson:forward",0),t.fire("firstperson:strafe",0),t.fire("leftjoystick:disable")):a.identifier===this.rightStick.identifier&&(this.rightStick.identifier=-1,t.fire("rightjoystick:disable"))}}.bind(this),addEventListeners=function(){i.addEventListener("touchstart",s,!1),i.addEventListener("touchmove",a,!1),i.addEventListener("touchend",r,!1)};this.on("enable",addEventListeners),this.on("disable",(function(){i.removeEventListener("touchstart",s,!1),i.removeEventListener("touchmove",a,!1),i.removeEventListener("touchend",r,!1)})),addEventListeners()},TouchInput.prototype.update=function(t){var e=this.app;if(-1!==this.leftStick.identifier){applyRadialDeadZone(this.leftStick.pos,this.remappedPos,this.deadZone,0);var i=this.remappedPos.x;this.lastStrafe!==i&&(e.fire("firstperson:strafe",i),this.lastStrafe=i);var s=-this.remappedPos.y;this.lastForward!==s&&(e.fire("firstperson:forward",s),this.lastForward=s)}if(-1!==this.rightStick.identifier){applyRadialDeadZone(this.rightStick.pos,this.remappedPos,this.deadZone,0);var a=-this.remappedPos.x*this.turnSpeed*t,r=-this.remappedPos.y*this.turnSpeed*t;e.fire("firstperson:look",a,r)}};var GamePadInput=pc.createScript("gamePadInput");GamePadInput.attributes.add("deadZoneLow",{title:"Low Dead Zone",description:"Radial thickness of inner dead zone of pad's joysticks. This dead zone ensures that all pads report a value of 0 for each joystick axis when untouched.",type:"number",min:0,max:.4,default:.2}),GamePadInput.attributes.add("deadZoneHigh",{title:"High Dead Zone",description:"Radial thickness of outer dead zone of pad's joysticks. This dead zone ensures that all pads can reach the -1 and 1 limits of each joystick axis.",type:"number",min:0,max:.4,default:.2}),GamePadInput.attributes.add("turnSpeed",{title:"Turn Speed",description:"Maximum turn speed in degrees per second",type:"number",default:150}),GamePadInput.prototype.initialize=function(){this.lastStrafe=0,this.lastForward=0,this.lastJump=!1,this.remappedPos=new pc.Vec2,this.leftStick={center:new pc.Vec2,pos:new pc.Vec2},this.rightStick={center:new pc.Vec2,pos:new pc.Vec2};var addEventListeners=function(){window.addEventListener("gamepadconnected",(function(t){})),window.addEventListener("gamepaddisconnected",(function(t){}))};this.on("enable",addEventListeners),this.on("disable",(function(){window.removeEventListener("gamepadconnected",(function(t){})),window.removeEventListener("gamepaddisconnected",(function(t){}))})),addEventListeners()},GamePadInput.prototype.update=function(t){for(var e=this.app,i=navigator.getGamepads?navigator.getGamepads():[],s=0;s<i.length;s++){var a=i[s];if(a&&"standard"===a.mapping&&a.axes.length>=4){this.leftStick.pos.set(a.axes[0],a.axes[1]),applyRadialDeadZone(this.leftStick.pos,this.remappedPos,this.deadZoneLow,this.deadZoneHigh);var r=this.remappedPos.x;this.lastStrafe!==r&&(e.fire("firstperson:strafe",r),this.lastStrafe=r);var n=-this.remappedPos.y;this.lastForward!==n&&(e.fire("firstperson:forward",n),this.lastForward=n),this.rightStick.pos.set(a.axes[2],a.axes[3]),applyRadialDeadZone(this.rightStick.pos,this.remappedPos,this.deadZoneLow,this.deadZoneHigh);var o=-this.remappedPos.x*this.turnSpeed*t,h=-this.remappedPos.y*this.turnSpeed*t;e.fire("firstperson:look",o,h),a.buttons[0].pressed&&!this.lastJump&&e.fire("firstperson:jump"),this.lastJump=a.buttons[0].pressed}}};pc.extend(pc,function(){function computeGaussian(e,t){return 1/Math.sqrt(2*Math.PI*t)*Math.exp(-e*e/(2*t*t))}function calculateBlurValues(e,t,s,o,r){e[0]=computeGaussian(0,r),t[0]=0,t[1]=0;var i,a,l=e[0];for(i=0,a=Math.floor(7.5);i<a;i++){var u=computeGaussian(i+1,r);e[2*i]=u,e[2*i+1]=u,l+=2*u;var h=2*i+1.5;t[4*i]=s*h,t[4*i+1]=o*h,t[4*i+2]=-s*h,t[4*i+3]=-o*h}for(i=0,a=e.length;i<a;i++)e[i]/=l}var BloomEffect=function(e){var t={aPosition:pc.SEMANTIC_POSITION},s=["attribute vec2 aPosition;","","varying vec2 vUv0;","","void main(void)","{","    gl_Position = vec4(aPosition, 0.0, 1.0);","    vUv0 = (aPosition + 1.0) * 0.5;","}"].join("\n"),o=["precision "+e.precision+" float;","","varying vec2 vUv0;","","uniform sampler2D uBaseTexture;","uniform float uBloomThreshold;","","void main(void)","{","    vec4 color = texture2D(uBaseTexture, vUv0);","","    gl_FragColor = clamp((color - uBloomThreshold) / (1.0 - uBloomThreshold), 0.0, 1.0);","}"].join("\n"),r=["precision "+e.precision+" float;","","#define SAMPLE_COUNT 15","","varying vec2 vUv0;","","uniform sampler2D uBloomTexture;","uniform vec2 uBlurOffsets[SAMPLE_COUNT];","uniform float uBlurWeights[SAMPLE_COUNT];","","void main(void)","{","    vec4 color = vec4(0.0);","    for (int i = 0; i < SAMPLE_COUNT; i++)","    {","        color += texture2D(uBloomTexture, vUv0 + uBlurOffsets[i]) * uBlurWeights[i];","    }","","    gl_FragColor = color;","}"].join("\n"),i=["precision "+e.precision+" float;","","varying vec2 vUv0;","","uniform float uBloomEffectIntensity;","uniform sampler2D uBaseTexture;","uniform sampler2D uBloomTexture;","","void main(void)","{","    vec4 bloom = texture2D(uBloomTexture, vUv0) * uBloomEffectIntensity;","    vec4 base = texture2D(uBaseTexture, vUv0);","","    base *= (1.0 - clamp(bloom, 0.0, 1.0));","","    gl_FragColor = base + bloom;","}"].join("\n");this.extractShader=new pc.Shader(e,{attributes:t,vshader:s,fshader:o}),this.blurShader=new pc.Shader(e,{attributes:t,vshader:s,fshader:r}),this.combineShader=new pc.Shader(e,{attributes:t,vshader:s,fshader:i});var a=e.width,l=e.height;this.targets=[];for(var u=0;u<2;u++){var h=new pc.Texture(e,{format:pc.PIXELFORMAT_R8_G8_B8_A8,width:a>>1,height:l>>1});h.minFilter=pc.FILTER_LINEAR,h.magFilter=pc.FILTER_LINEAR,h.addressU=pc.ADDRESS_CLAMP_TO_EDGE,h.addressV=pc.ADDRESS_CLAMP_TO_EDGE;var n=new pc.RenderTarget(e,h,{depth:!1});this.targets.push(n)}this.bloomThreshold=.25,this.blurAmount=4,this.bloomIntensity=1.25,this.sampleWeights=new Float32Array(15),this.sampleOffsets=new Float32Array(30)};return(BloomEffect=pc.inherits(BloomEffect,pc.PostEffect)).prototype=pc.extend(BloomEffect.prototype,{render:function(e,t,s){var o=this.device,r=o.scope;r.resolve("uBloomThreshold").setValue(this.bloomThreshold),r.resolve("uBaseTexture").setValue(e.colorBuffer),pc.drawFullscreenQuad(o,this.targets[0],this.vertexBuffer,this.extractShader),calculateBlurValues(this.sampleWeights,this.sampleOffsets,1/this.targets[1].width,0,this.blurAmount),r.resolve("uBlurWeights[0]").setValue(this.sampleWeights),r.resolve("uBlurOffsets[0]").setValue(this.sampleOffsets),r.resolve("uBloomTexture").setValue(this.targets[0].colorBuffer),pc.drawFullscreenQuad(o,this.targets[1],this.vertexBuffer,this.blurShader),calculateBlurValues(this.sampleWeights,this.sampleOffsets,0,1/this.targets[0].height,this.blurAmount),r.resolve("uBlurWeights[0]").setValue(this.sampleWeights),r.resolve("uBlurOffsets[0]").setValue(this.sampleOffsets),r.resolve("uBloomTexture").setValue(this.targets[1].colorBuffer),pc.drawFullscreenQuad(o,this.targets[0],this.vertexBuffer,this.blurShader),r.resolve("uBloomEffectIntensity").setValue(this.bloomIntensity),r.resolve("uBloomTexture").setValue(this.targets[0].colorBuffer),r.resolve("uBaseTexture").setValue(e.colorBuffer),pc.drawFullscreenQuad(o,t,this.vertexBuffer,this.combineShader,s)}}),{BloomEffect:BloomEffect}}());var Bloom=pc.createScript("bloom");Bloom.attributes.add("bloomIntensity",{type:"number",default:1,min:0,title:"Intensity"}),Bloom.attributes.add("bloomThreshold",{type:"number",default:.25,min:0,max:1,precision:2,title:"Threshold"}),Bloom.attributes.add("blurAmount",{type:"number",default:4,min:1,title:"Blur amount"}),Bloom.prototype.initialize=function(){this.effect=new pc.BloomEffect(this.app.graphicsDevice),this.effect.bloomThreshold=this.bloomThreshold,this.effect.blurAmount=this.blurAmount,this.effect.bloomIntensity=this.bloomIntensity;var e=this.entity.camera.postEffects;e.addEffect(this.effect),this.on("attr",(function(e,t){this.effect[e]=t}),this),this.on("state",(function(t){t?e.addEffect(this.effect):e.removeEffect(this.effect)})),this.on("destroy",(function(){e.removeEffect(this.effect)}))};var Controller=pc.createScript("controller");Controller.attributes.add("maxGrabDistance",{type:"number",title:"Max Grab Distance",default:.1}),Controller.prototype.initialize=function(){this.ray=new pc.Ray,this.vecA=new pc.Vec3,this.vecB=new pc.Vec3,this.quat=new pc.Quat,this.color=new pc.Color(1,1,1),this.holdingEntity=null,this.teleportableEntity=null,this.hoverEntity=null,this.hoverPoint=new pc.Vec3,this.teleportable=!0,this.active=!0,this.mouseCoords=new pc.Vec2,this.holdingDistance=0,this.holdingOffset=new pc.Vec3,this.holdingNoOffset=!0,this.modelEntity=this.entity.findByName("Model"),this.grabAnchor=new pc.Entity,this.grabAnchor.reparent(this.entity)},Controller.prototype.setInputSource=function(t,i){var e=this;if(this.inputSource=t,this.inputSource.once("remove",this.onRemove,this),this.on("hover",this.onHover,this),this.on("blur",this.onBlur,this),this.inputSource.on("selectstart",this.onSelectStart,this),this.inputSource.on("selectend",this.onSelectEnd,this),t.hand){this.joints=[];for(var o=new pc.StandardMaterial,s=0;s<t.hand.joints.length;s++){var n=t.hand.joints[s],h=new pc.Entity;h.addComponent("model",{type:"box"}),h.joint=n,h.model.material=o,this.joints.push(h),this.entity.addChild(h)}t.hand.on("trackinglost",(function(){this.joints[0].model.material.diffuse.set(1,0,0),this.joints[0].model.material.update()}),this),t.hand.on("tracking",(function(){this.joints[0].model.material.diffuse.set(1,1,1),this.joints[0].model.material.update()}),this)}else i&&(i.ready((function(){if(this.entity.parent){var t=i.resource,o=new Blob([t]);this.app.assets.loadFromUrlAndFilename(URL.createObjectURL(o),"container.glb","container",(function(t,i){if(!e.entity.parent)return i.unload(),void e.app.assets.remove(i);t?console.error(t):(e.modelEntity.setLocalScale(1,1,1),e.modelEntity.model.type="asset",e.modelEntity.model.asset=i.resource.model,e.modelEntity.containerAsset=i)}))}}),this),this.app.assets.load(i))},Controller.prototype.onRemove=function(){this.modelEntity.containerAsset&&(console.log(this.modelEntity.containerAsset),this.modelEntity.containerAsset.unload(),this.app.assets.remove(this.modelEntity.containerAsset),this.modelEntity.containerAsset=null),this.entity.destroy()},Controller.prototype.onSelectStart=function(){this.pick(),this.teleportableEntity?this.app.xr.active&&(this.app.fire("teleport:to",this.hoverPoint),this.hoverEntity.fire("object:interact",this)):this.hoverEntity&&!this.holdingEntity&&this.hoverEntity.fire("object:hold",this)},Controller.prototype.onSelectEnd=function(){this.teleportableEntity&&!this.app.xr.active&&this.teleportable&&this.app.fire("teleport:to",this.hoverPoint),this.hoverEntity&&this.hoverEntity.fire("object:attemptuse",this),this.holdingEntity&&this.holdingEntity.fire("object:release",this)},Controller.prototype.getAttachPosition=function(){return this.grabAnchor.getPosition()},Controller.prototype.getAttachRotation=function(){return this.grabAnchor.getRotation()},Controller.prototype.attach=function(t){this.holdingEntity||(this.holdingEntity=t,this.grabAnchor.setPosition(t.getPosition()),this.holdingDistance=t.getPosition().distance(this.app.mainCamera.getPosition()))},Controller.prototype.detach=function(t){this.holdingEntity&&(this.holdingEntity=null)},Controller.prototype.getHeldEntity=function(){return this.holdingEntity},Controller.prototype.updateAttachment=function(t,i){t.setPosition(this.getAttachPosition()),this.quat.mul2(this.getAttachRotation(),i),t.setRotation(this.quat)},Controller.prototype.filterPicker=function(t){return this.holdingEntity!==t},Controller.prototype.pick=function(){this.inputSource?this.ray.set(this.inputSource.getOrigin(),this.inputSource.getDirection()):pc.Mouse.isPointerLocked()?this.ray.set(this.app.mainCamera.getPosition(),this.app.mainCamera.forward):(this.app.mainCamera.camera.screenToWorld(this.mouseCoords.x,this.mouseCoords.y,this.app.mainCamera.camera.nearClip,this.vecA),this.app.mainCamera.camera.screenToWorld(this.mouseCoords.x,this.mouseCoords.y,this.app.mainCamera.camera.farClip,this.vecB),this.vecB.sub(this.vecA).normalize(),this.ray.set(this.vecA,this.vecB),this.holdingEntity?(this.vecB.scale(this.holdingDistance),this.vecB.add(this.vecA),this.holdingNoOffset&&(this.holdingNoOffset=!1,this.holdingOffset.copy(this.grabAnchor.getPosition()).sub(this.vecB)),this.vecB.add(this.holdingOffset),this.grabAnchor.setPosition(this.vecB)):this.holdingNoOffset=!0);var t=this.app.shapeWorld.raycast(this.ray,this.filterPicker.bind(this),this.hoverPoint),i=!1;(this.active||(t=null),this.hoverEntity!==t&&(this.hoverEntity&&this.hoverEntity.fire("object:offhover",this),t&&t.fire("object:onhover",this),this.hoverEntity=t),this.hoverEntity)&&(this.holdingEntity||this.hoverEntity.tags.has("floor")&&this.hoverEntity.up.dot(this.ray.direction)<=0&&(i=!0));this.teleportableEntity=i?this.hoverEntity:null},Controller.prototype.update=function(t){if(this.inputSource&&"gaze"!==this.inputSource.targetRayMode&&(this.vecA.copy(this.inputSource.getOrigin()),this.vecB.copy(this.inputSource.getDirection()),this.vecB.scale(1e3).add(this.vecA),this.inputSource.selecting?this.color.set(0,1,0):this.color.set(1,1,1),this.app.renderLine(this.vecA,this.vecB,this.color)),this.inputSource&&this.inputSource.hand)for(var i=0;i<this.joints.length;i++){var e=this.joints[i].joint,o=2*e.radius;this.joints[i].setLocalScale(o,o,o),this.joints[i].setPosition(e.getPosition()),this.joints[i].setRotation(e.getRotation())}else this.inputSource&&this.inputSource.grip?(this.modelEntity.enabled=!0,this.entity.setPosition(this.inputSource.getPosition()),this.entity.setRotation(this.inputSource.getRotation())):(this.modelEntity.enabled=!1,this.inputSource&&"gaze"!==this.inputSource.targetRayMode||(this.entity.setPosition(this.app.mainCamera.getPosition()),this.entity.setRotation(this.app.mainCamera.getRotation())));this.pick(),this.teleportableEntity?(this.vecB.copy(this.hoverEntity.up).scale(.01),this.vecA.copy(this.hoverPoint).add(this.vecB),this.app.fire("teleport:transform",this.vecA,this.hoverEntity.getRotation()),this.app.fire("teleport:show")):this.app.fire("teleport:hide")};var KeyboardInputFly=pc.createScript("KeyboardInputFly");KeyboardInputFly.prototype.initialize=function(){this.orbitCamera=this.entity.script.orbitCamera},KeyboardInputFly.prototype.postInitialize=function(){this.orbitCamera&&(this.startDistance=this.orbitCamera.distance,this.startYaw=this.orbitCamera.yaw,this.startPitch=this.orbitCamera.pitch,this.startPivotPosition=this.orbitCamera.pivotPoint.clone())},KeyboardInputFly.prototype.update=function(t){this.orbitCamera&&this.app.keyboard.wasPressed(pc.KEY_SPACE)&&(this.orbitCamera.reset(this.startYaw,this.startPitch,this.startDistance),this.orbitCamera.pivotPoint=this.startPivotPosition)};var VirtualJoystick=pc.createScript("virtualJoystick");VirtualJoystick.attributes.add("stick",{type:"entity"}),VirtualJoystick.attributes.add("enableEvent",{type:"string"}),VirtualJoystick.attributes.add("moveEvent",{type:"string"}),VirtualJoystick.attributes.add("disableEvent",{type:"string"}),VirtualJoystick.prototype.initialize=function(){var t=this.app;t.on(this.enableEvent,(function(t,i){this.entity.setLocalPosition(t,-i,0),this.stick.setLocalPosition(t,-i,0),this.entity.element.enabled=!0,this.stick.element.enabled=!0}),this),t.on(this.moveEvent,(function(t,i){this.stick.setLocalPosition(t,-i,0)}),this),t.on(this.disableEvent,(function(){this.entity.element.enabled=!1,this.stick.element.enabled=!1}),this)};var Vr=pc.createScript("vr");Vr.attributes.add("elementUnsupported",{type:"entity",title:"Unsupported Message"}),Vr.attributes.add("elementUnavailable",{type:"entity",title:"Unavailable Message"}),Vr.attributes.add("elementHttpsRequired",{type:"entity",title:"HTTPS Required Message"}),Vr.attributes.add("cameraEntity",{type:"entity",title:"Camera"}),Vr.prototype.initialize=function(){this.app.keyboard.on("keydown",(function(e){e.key===pc.KEY_ESCAPE&&this.app.xr.active&&this.app.xr.end()}),this),this.errorMessage(),this.app.xr.on("end",(function(){this.app.root.findByName("A_PC_Mobile").enabled=!0,this.app.root.findByName("B_VR").enabled=!1,this.app.scene.exposure=1,this.app.root.findByName("GlassMatChanger").render._meshInstances[0].material.opacity=.4,this.app.root.findByName("GlassMatChanger").render._meshInstances[0].material.update(),this.app.root.findByName("WaterMatChanger").render._meshInstances[0].material.opacity=.5,this.app.root.findByName("WaterMatChanger").render._meshInstances[0].material.update()}))},Vr.prototype.errorMessage=function(){if(this.app.xr.supported){if(this.elementHttpsRequired.enabled=!1,this.elementUnsupported.enabled=!1,this.elementUnavailable.enabled=!1,!this.app.xr.active)var e=this.app.xr&&!this.app.xr.active&&this.app.xr.isAvailable(pc.XRTYPE_VR);e||(this.elementUnavailable.enabled=!0)}else this.elementUnavailable.enabled=!1,"https:"==window.location.protocol?(this.elementUnsupported.enabled=!0,this.elementHttpsRequired.enabled=!1):(this.elementUnsupported.enabled=!1,this.elementHttpsRequired.enabled=!0)},Vr.prototype.sessionStart=function(){this.app.xr.supported&&(this.app.xr.active||this.app.xr.isAvailable(pc.XRTYPE_VR)&&(window.DeviceOrientationEvent&&window.DeviceOrientationEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(function(e){"granted"===e&&window.addEventListener("deviceorientation",function(e){this.cameraEntity.camera.startXr(pc.XRTYPE_VR,pc.XRSPACE_LOCALFLOOR),this.app.root.findByName("MapCameras").enabled=!1,this.app.scene.exposure=1,this.app.root.findByName("GlassMatChanger").render._meshInstances[0].material.opacity=.1,this.app.root.findByName("GlassMatChanger").render._meshInstances[0].material.update(),this.app.root.findByName("WaterMatChanger").render._meshInstances[0].material.opacity=.2,this.app.root.findByName("WaterMatChanger").render._meshInstances[0].material.update()}.bind(this))}.bind(this)).catch(console.error):(this.cameraEntity.camera.startXr(pc.XRTYPE_VR,pc.XRSPACE_LOCALFLOOR),this.app.root.findByName("MapCameras").enabled=!1,this.app.scene.exposure=1,this.app.root.findByName("GlassMatChanger").render._meshInstances[0].material.opacity=.1,this.app.root.findByName("GlassMatChanger").render._meshInstances[0].material.update(),this.app.root.findByName("WaterMatChanger").render._meshInstances[0].material.opacity=.2,this.app.root.findByName("WaterMatChanger").render._meshInstances[0].material.update())))};var ClipPlane=pc.createScript("clipPlane");ClipPlane.attributes.add("entities",{type:"entity",array:!0,description:"Add entities to be clipped by this clip plane."}),ClipPlane.attributes.add("clipPlaneChunk",{title:"Clip Plane Shader",type:"asset",assetType:"shader",description:"Shader that implements clip plane logic"}),ClipPlane.attributes.add("diffuseChunk",{title:"Clip Plane Shader",type:"asset",assetType:"shader",description:"Shader that implements clip plane logic"}),ClipPlane.prototype.initialize=function(){this.device=this.app.graphicsDevice,this.boundObj=this.entity.root.findByName("Focus"),this.position=new pc.Vec3(0,0,0),this.normal=new pc.Vec3(0,1,0),this.planeDataF32=new Float32Array(4),this.bound=new Float32Array(4),this.entitiesClipped=[],this.entities.length>0&&this.entities.forEach((e=>{this.addEntity(e)})),this.on("disable",(function(){this.device.scope.resolve("clip_enabled").setValue(0)}),this),this.on("enable",(function(){this.device.scope.resolve("clip_enabled").setValue(1)}),this),this.app.on("clipPlane:set",this.updateClipPlane,this),this.app.on("clipPlane:addEntity",this.addEntity,this),this.app.on("clipPlane:removeEntity",this.removeEntity,this),this.app.on("clipPlane:enable",(function(){console.log("check"),this._enabled=!0}),this),this.app.on("clipPlane:disable",(function(){this._enabled=!1}),this),this.updateClipPlane(this.position,this.normal),this._enabled=!1},ClipPlane.prototype.addEntity=function(e){this.setupEntity(e),e&&-1===this.entitiesClipped.indexOf(e)&&(this.entitiesClipped.push(e),this.updateClipPlane(this.position,this.normal))},ClipPlane.prototype.removeEntity=function(e){const t=this.entitiesClipped.indexOf(e);t>-1&&(this.cancelEntity(e),this.entitiesClipped.splice(t,1),this.updateClipPlane(this.position,this.normal))},ClipPlane.prototype.setupEntity=function(e){e&&(e.model&&e.model.meshInstances?e.model.meshInstances.forEach((e=>{const t=e.material;t.chunks.startPS=this.clipPlaneChunk.resource,t.chunks.diffusePS=this.diffuseChunk.resource,t.setParameter("uDiffuseMap",t.diffuseMap),this.clipPlaneChunk.on("load",(()=>{t.chunks.startPS=this.clipPlaneChunk.resource,t.chunks.diffusePS=this.diffuseChunk.resource,t.setParameter("uDiffuseMap",t.diffuseMap)}),this),t.setParameter("clip_enabled",0)})):console.warn("[ClipPlane] Entity missing model component or model:",e.name))},ClipPlane.prototype.cancelEntity=function(e){e&&(e.model&&e.model.meshInstances?e.model.meshInstances.forEach((e=>{e.material.setParameter("clip_enabled",0)})):console.warn("[ClipPlane] Entity missing model component or model:",e.name))},ClipPlane.prototype.updateClipPlane=function(e,t){if(0!==this.entitiesClipped.length){var i=this.position.copy(e),n=this.normal.copy(t);this.planeDataF32[0]=n.x,this.planeDataF32[1]=n.y,this.planeDataF32[2]=n.z,this.planeDataF32[3]=-(n.x*i.x+n.y*i.y+n.z*i.z),this.bound[0]=this.boundObj.getPosition().x,this.bound[1]=this.boundObj.getPosition().z,this.bound[2]=this.boundObj.getLocalScale().x/2,this.bound[3]=this.boundObj.getLocalScale().z/2,this.entitiesClipped.forEach((e=>{e.model.meshInstances.forEach((e=>{const t=e.material;t.cull=pc.CULLFACE_NONE,e.setParameter("clip_plane",this.planeDataF32),e.setParameter("clip_enabled",+this._enabled),e.setParameter("clip_bound",this.bound),e.setParameter("uDiffuseMap",t.diffuseMap)}))}))}};var Ui=pc.createScript("ui");Ui.attributes.add("html",{type:"asset",assetType:"html"}),Ui.attributes.add("css",{type:"asset",assetType:"css"}),Ui.prototype.initialize=function(){this.fixedHtml="",this.fixedCss="",this.fixUp(),this.createCss(),this.createHtml(),this.initUi()},Ui.prototype.fixUp=function(){this.fixedHtml=this.html.resource,this.fixedCss=this.css.resource,this.app.assets.findByTag("ui").forEach(function(e){var t=new RegExp(e.name,"gi"),n=e.getFileUrl();this.fixedHtml=this.fixedHtml.replace(t,n),this.fixedCss=this.fixedCss.replace(t,n)}.bind(this))},Ui.prototype.createCss=function(){var e=document.createElement("style");e.type="text/css",e.innerHTML=this.fixedCss,this.css.on("load",(function(){this.fixUp(),e.innerHTML=this.fixedCss}),this),document.getElementsByTagName("head")[0].appendChild(e)},Ui.prototype.createHtml=function(){var e=document.createElement("div");e.innerHTML=this.fixedHtml,this.html.on("load",(function(){this.fixUp(),e.innerHTML=this.fixedHtml,this.initUi()}),this),document.body.appendChild(e)},Ui.prototype.initUi=function(){var e=this.app;["logo"].forEach((function(e){el=document.getElementById(e),el.addEventListener("mousedown",(function(e){e.stopPropagation()})),el.addEventListener("touchstart",(function(e){e.stopPropagation()}))})),["fullscreen-button"].forEach((function(e){el=document.getElementById(e),el.addEventListener("mousedown",(function(e){e.stopPropagation()})),el.addEventListener("touchstart",(function(e){e.stopPropagation()}))})),["camera-button"].forEach((function(e){el=document.getElementById(e),el.addEventListener("mousedown",(function(e){e.stopPropagation()})),el.addEventListener("touchstart",(function(e){e.stopPropagation()}))})),["vr-button"].forEach((function(e){el=document.getElementById(e),el.addEventListener("mousedown",(function(e){e.stopPropagation()})),el.addEventListener("touchstart",(function(e){e.stopPropagation()}))})),["joseon-button"].forEach((function(e){el=document.getElementById(e),el.addEventListener("mousedown",(function(e){e.stopPropagation()})),el.addEventListener("touchstart",(function(e){e.stopPropagation()}))})),["japan-button"].forEach((function(e){el=document.getElementById(e),el.addEventListener("mousedown",(function(e){e.stopPropagation()})),el.addEventListener("touchstart",(function(e){e.stopPropagation()}))})),["park-button"].forEach((function(e){el=document.getElementById(e),el.addEventListener("mousedown",(function(e){e.stopPropagation()})),el.addEventListener("touchstart",(function(e){e.stopPropagation()}))})),el=document.getElementById("fullscreen-button"),document.documentElement.requestFullscreen?el.addEventListener("click",(function(e){el.classList.contains("checked")?document.exitFullscreen&&document.exitFullscreen():document.documentElement.requestFullscreen(),el.classList.toggle("checked")})):el.classList.add("hidden"),el=document.getElementById("camera-button"),el.classList.add("hidden"),el.addEventListener("click",(function(e){trigger()})),trigger=function(){if(e.root.findByName("building").enabled){el=document.getElementById("camera-button"),el.classList.toggle("checked");var t=e.root.findByName("WalkPlayer"),n=e.root.findByName("FlyCamera"),o=e.root.findByName("Assessment"),i=e.root.findByName("Entrance"),a=e.root.findByName("MapCameras"),r=e.root.findByName("ExposureController");t.enabled=!t.enabled,n.enabled=!n.enabled,o.enabled=!o.enabled,i.enabled=!i.enabled,a.enabled=!1,r.enabled=!r.enabled,e.root.findByName("FlyCamera").script.orbitCamera.reset(e.root.findByName("FlyCamera").script.KeyboardInputFly.startYaw,e.root.findByName("FlyCamera").script.KeyboardInputFly.startPitch,e.root.findByName("FlyCamera").script.KeyboardInputFly.startDistance),e.root.findByName("FlyCamera").script.orbitCamera.pivotPoint=e.root.findByName("FlyCamera").script.KeyboardInputFly.startPivotPosition,e.root.findByName("FlyCamera").enabled&&(e.scene.exposure=2),el.classList.toggle("hidden")}},e.on("cameraswitch:trigger",trigger),el=document.getElementById("vr-button"),el.addEventListener("click",(function(t){Vrstate=e.root.findByName("VrState"),Vrstate.enabled=!Vrstate.enabled,e.xr&&!e.xr.active&&e.xr.isAvailable(pc.XRTYPE_VR)&&(e.root.findByName("A_PC_Mobile").enabled=!1,e.root.findByName("B_VR").enabled=!0,Vrstate.script.vr.sessionStart())})),el=document.getElementById("joseon-button"),el.addEventListener("click",(function(t){e.fire("history:modeltrigger",0),e.fire("reset:character")})),el=document.getElementById("japan-button"),el.addEventListener("click",(function(t){e.fire("history:modeltrigger",1),e.fire("reset:character")})),el=document.getElementById("park-button"),el.addEventListener("click",(function(t){e.fire("history:modeltrigger",2),e.fire("reset:character")}))};var DoClip=pc.createScript("doClip");DoClip.attributes.add("speed",{type:"number",default:1,description:"initial moving"}),DoClip.attributes.add("initialDistance",{type:"number",default:50,description:"initial Focus distance"}),DoClip.attributes.add("exposure",{type:"number",default:8,description:"exposure when clipping"}),DoClip.attributes.add("plans",{type:"json",array:!0,schema:[{name:"plan",type:"entity",title:"Plan Entity"},{name:"height",type:"number",default:2,title:"CuttingHeight"},{name:"focusXZ",type:"vec2",title:"Focus coordinate to be used"},{name:"distance",type:"number",default:20,title:"FocusDistance"}]}),DoClip.prototype.initialize=function(i){this.active=0,this.initialFocus=this.entity.root.findByName("Focus"),this.oriLoc=this.entity.getPosition().y,this.alpha=0,this.preLoc=this.oriLoc,this.clipLoc=this.oriLoc,this.clickcount=0,this.app.on("clipPlane:disable",(function(){this.clickcount=0,this.alpha=1,this.clipLoc=this.oriLoc}),this),this.app.on("clipPlane:clicked",(function(i){this.active=1,this.clickcount+=1,this.clickcount>this.plans.length&&(this.clickcount=0),this.app.fire("clipPlane:count",this.clickcount),console.log(this.clipLoc),console.log(this.entity.getPosition().y),this.preLoc=this.entity.getPosition().y,0===this.clickcount?(this.oriCameraLoc=this.entity.root.findByName("FlyCamera").script.orbitCamera._pivotPoint,this.oriCameraDistance=this.entity.root.findByName("FlyCamera").script.orbitCamera._distance,this.focusloc=this.initialFocus.getPosition(),this.focusdistance=this.initialDistance,this.clipLoc=this.oriLoc):(this.app.fire("clipPlane:enable"),this.clipLoc=this.plans[this.clickcount-1].plan.localPosition.y+this.plans[this.clickcount-1].height,this.oriCameraLoc=this.entity.root.findByName("FlyCamera").script.orbitCamera._pivotPoint,this.oriCameraDistance=this.entity.root.findByName("FlyCamera").script.orbitCamera._distance,this.focusloc=new pc.Vec3(this.plans[this.clickcount-1].focusXZ.x,this.plans[this.clickcount-1].plan.localPosition.y,this.plans[this.clickcount-1].focusXZ.y),this.focusdistance=this.plans[this.clickcount-1].distance),this.alpha=0}),this)},DoClip.prototype.update=function(i){this.clipLoc!=this.preLoc&&(this.alpha+=.1*this.speed/Math.abs(this.clipLoc-this.preLoc)),this.alpha>=1?(this.alpha=1,0==this.clickcount&&(this.clickcount=0,this.clipLoc=this.oriLoc)):this.oriCameraLoc&&this.focusloc&&(this.entity.root.findByName("FlyCamera").script.orbitCamera._pivotPoint=this.lerpeVec3(this.oriCameraLoc,this.focusloc,this.alpha),this.entity.root.findByName("FlyCamera").script.orbitCamera._targetDistance=this.lerpe(this.oriCameraDistance,this.focusdistance,this.alpha),this.entity.setPosition(0,this.lerpe(a=this.preLoc,b=this.clipLoc,alpha=this.alpha),0))},DoClip.prototype.lerpe=function(i,t,s){return i+(1-Math.pow(1-s,3))*(t-i)},DoClip.prototype.lerpeVec3=function(i,t,s){const o=i.x+(1-Math.pow(1-s,3))*(t.x-i.x),c=i.y+(1-Math.pow(1-s,3))*(t.y-i.y),e=i.z+(1-Math.pow(1-s,3))*(t.z-i.z);return new pc.Vec3(o,c,e)};var EnableCodeOnload=pc.createScript("enableCodeOnload");EnableCodeOnload.prototype.initialize=function(){this.active=0,this.c=0},EnableCodeOnload.prototype.update=function(t){const e=this.entity.script.clipPlane.entities;0==this.c&&e.length>0&&(e.forEach((t=>{this.active+=!!t.model.meshInstances})),this.active==e.length&&(this.entity.script.clipPlane.enabled=1,this.c=1,console.log("adawdawd")),this.active=0)};var BoxAdd=pc.createScript("boxAdd");BoxAdd.attributes.add("grid",{type:"json",schema:[{name:"x",type:"number",default:3,title:"xsize of grid"},{name:"z",type:"number",default:3,title:"zsize of grid"}]}),BoxAdd.prototype.initialize=function(){const t=this.entity.getLocalScale().x,i=this.entity.getLocalScale().z;for(let e=0;e<t/this.grid.x;e++)for(let d=0;d<i/this.grid.z;d++){const o=new pc.Entity;o.setLocalPosition((e-t/(2*this.grid.x))*this.grid.x,0,(d-i/(2*this.grid.z))*this.grid.z),o.addComponent("collision"),o.collision.type="box",o.collision.halfExtents=new pc.Vec3(this.grid.x/2-.01,.5,this.grid.z/2-.01),this.entity.parent.addChild(o),o.tags.add("grid")}},BoxAdd.prototype.update=function(t){};class AmmoDebugDrawer{constructor(e={}){if(!window.Ammo)return void console.warn("Warning! Trying to initialize Ammo Debug Drawer without Ammo lib in the project. Aborting.");const t=pc.Application.getApplication(),o=t.scene.layers,n=this,r=e.layer||o.getLayerByName("Debug Draw")||o.getLayerById(pc.LAYERID_UI),{entity:s,distance:i,ignorePartials:a}=e.limit||{},c=new AmmoDebugDrawer.Pool,d=new pc.Vec3,u=new pc.Vec3;new pc.Vec3;let l=1,p=!1;const m=new Ammo.DebugDrawer;m.drawLine=function drawLine(e,t,o){const n=Ammo.wrapPointer(e,Ammo.btVector3),r=Ammo.wrapPointer(t,Ammo.btVector3),l=Ammo.wrapPointer(o,Ammo.btVector3);if(s){d.set(n.x(),n.y(),n.z()),u.set(r.x(),r.y(),r.z());const e=s.getPosition(),t=e.distance(d),o=e.distance(u);(t<i&&o<i||s&&!a&&(t<i||o<i))&&(c.pushPos(d.x,d.y,d.z,u.x,u.y,u.z),c.pushColor(l.x(),l.y(),l.z(),1,l.x(),l.y(),l.z(),1))}else c.pushPos(n.x(),n.y(),n.z(),r.x(),r.y(),r.z()),c.pushColor(l.x(),l.y(),l.z(),1,l.x(),l.y(),l.z(),1)}.bind(this),m.drawContactPoint=function drawContactPoint(e,t,o,n,r){const s=Ammo.wrapPointer(e,Ammo.btVector3),i=Ammo.wrapPointer(t,Ammo.btVector3),a=Ammo.wrapPointer(r,Ammo.btVector3),d=s.x(),u=s.y(),l=s.z();c.pushPos(d,u,l,d+.5*i.x(),u+.5*i.y(),l+.5*i.z()),c.pushColor(a.x(),a.y(),a.z(),1,a.x(),a.y(),a.z(),1)}.bind(this),m.reportErrorWarning=function reportErrorWarning(e){}.bind(this),m.draw3dText=function draw3dText(e,t){}.bind(this),m.setDebugMode=function setDebugMode(e){l=e}.bind(this),m.getDebugMode=function getDebugMode(){return l}.bind(this),m.enable=function enable(){n.enabled=!0}.bind(this),m.disable=disable.bind(this),m.update=update.bind(this);const b=t.systems.rigidbody.dynamicsWorld;function clear(){c.clear()}function disable(){n.enabled=!1}function update(){p&&b.debugDrawWorld()}function postUpdate(){p&&(!function draw(){try{c.entries.forEach((e=>{t.drawLineArrays(e.positions,e.colors,!1,r)}))}catch(e){console.warn("Error drawing debug lines",e),disable()}}(),clear())}b.setDebugDrawer(m),n.clear=clear,n.toggle=function toggle(){n.enabled=!p},Object.defineProperties(n,{enabled:{get:()=>p,set:e=>{p=e,p?(t.systems.on("update",update,n),t.systems.on("postUpdate",postUpdate,n)):(t.systems.off("update",update,n),t.systems.off("postUpdate",postUpdate,n),clear())}},mode:{get:()=>l,set:e=>{l=e}}})}}AmmoDebugDrawer.Pool=class Pool{constructor(){const e=this,t=new Map;let o=0;function _add(e){const o={positions:[],colors:[]};return t.set(e,o),o}function _getEntry(e,n){let r=t.get(o);return r[e].length+n>64e3&&(r=_add(++o)),r}t.set(o,{positions:[],colors:[]}),e.entries=t,e.clear=function clear(){t.clear(),o=0,_add(o)},e.pushColor=function pushColor(e,t,o,n,r,s,i,a){_getEntry("colors",8).colors.push(e,t,o,n,r,s,i,a)},e.pushPos=function pushPos(e,t,o,n,r,s){_getEntry("positions",6).positions.push(e,t,o,n,r,s)},_add(o)}};class Example extends pc.ScriptType{initialize(){const e=this.app.root.findByName("FlyCamera");new AmmoDebugDrawer({limit:{entity:e,distance:1e3}}).enabled=!0,this.app.on("ui:mode-select",this.changeMode,this),this.cubeIndex=0,this.allSpawned=!1,this.reset()}reset(){this.time=0,this.delay=pc.math.random(0,1)}changeMode(e){this.renderer&&(this.renderer.mode=e)}}pc.registerScript(Example,"example");var CollideCause=pc.createScript("collideCause");CollideCause.attributes.add("material",{type:"asset",assetType:"material"}),CollideCause.prototype.initialize=function(){this.entity.rigidbody.on("triggerenter",this.triggerenter,this)},CollideCause.prototype.triggerenter=function(e){},CollideCause.prototype.update=function(e){};var ChangeModelAsset=pc.createScript("changeModelAsset");ChangeModelAsset.attributes.add("history",{array:!0,type:"json",schema:[{name:"model",type:"asset",title:"Model for nth phase"},{name:"title",type:"string",title:"Title for nth phase"}]}),ChangeModelAsset.prototype.initialize=function(){this.app.on("history:modelchange",this.changeModel,this)},ChangeModelAsset.prototype.changeModel=function(e){this.entity.model.asset=this.history[e].model._id,this.entity.model.enabled=0,this.app.fire("clipPlane:addEntity",this.entity)},ChangeModelAsset.prototype.update=function(e){0==this.entity.model.enabled&&(this.entity.model.enabled=1)};var ChangeModelTrigger=pc.createScript("changeModelTrigger");ChangeModelTrigger.attributes.add("floor",{type:"number",default:1,description:"floor height"}),ChangeModelTrigger.attributes.add("speed",{type:"number",default:1,description:"move speed"}),ChangeModelTrigger.prototype.initialize=function(){this.alpha=0,this.active=0,this.direction=1,this.when=1,this.oriLoc=this.entity.getPosition().y,this.app.on("history:modeltrigger",(function(i){this.active=1,this.when=i,this.app.fire("clipPlane:enable"),this.startLoc=this.entity.getPosition().y}),this)},ChangeModelTrigger.prototype.update=function(i){1==this.active&&(this.alpha+=i*this.speed,this.alpha>1&&1==this.direction&&(this.alpha=0,this.direction=-1,this.app.fire("history:modelchange",this.when)),this.alpha>1&&-1==this.direction&&(this.alpha=0,this.direction=1,this.active=0,this.app.fire("clipPlane:disable")),1==this.direction?this.entity.setPosition(0,this.lerpe(this.startLoc,this.floor,this.alpha),0):-1==this.direction&&this.entity.setPosition(0,this.lerpe(this.floor,this.oriLoc,this.alpha),0),console.log(this.startLoc,this.floor,this.oriLoc))},ChangeModelTrigger.prototype.lerpe=function(i,t,e){return i+(1-Math.pow(1-e,3))*(t-i)};var ClipSetPosition=pc.createScript("clipSetPosition");ClipSetPosition.prototype.initialize=function(){},ClipSetPosition.prototype.update=function(i){this.app.fire("clipPlane:set",this.entity.getPosition(),this.entity.up)};var ChangeModelAssetFloor=pc.createScript("changeModelAssetFloor");ChangeModelAssetFloor.attributes.add("history",{array:!0,type:"json",schema:[{name:"model",type:"asset",title:"Model for nth phase"},{name:"title",type:"string",title:"Title for nth phase"}]}),ChangeModelAssetFloor.prototype.initialize=function(){this.app.on("history:modelchange",this.changeModel,this)},ChangeModelAssetFloor.prototype.changeModel=function(t){this.entity.collision.asset=this.history[t].model._id,this.entity.model.asset=this.history[t].model._id,this.app.fire("clipPlane:addEntity",this.entity),this.entity.findByName("water").enabled=!t},ChangeModelAssetFloor.prototype.update=function(t){};var RaycastAndFind=pc.createScript("raycastAndFind");RaycastAndFind.attributes.add("distance",{type:"number"}),RaycastAndFind.attributes.add("cameraEntity",{type:"entity",title:"Camera Entity"}),RaycastAndFind.prototype.initialize=function(){},RaycastAndFind.prototype.update=function(t){const i=this.cameraEntity.from,a=this.cameraEntity.to;if(null!=i&null!=a){const t=this.app.systems.rigidbody.raycastFirstByTag(i,a,"trigger");this.previousname=this.name,null!=t?(this.ptdist=this.getDistance(t.point,this.cameraEntity.position),this.ptdist<this.distance&&(this.name=t.entity.name)):this.name="null",this.name!=this.previousname&&("null"==this.name?this.app.fire("element:end",this.previousname):this.app.fire("element:start",this.name))}},RaycastAndFind.prototype.getDistance=function(t,i){var a=t.x-i.x,n=t.y-i.y,e=t.z-i.z;return Math.pow(Math.pow(a,2)+Math.pow(n,2)+Math.pow(e,2),.5)};var ElementTrigger=pc.createScript("elementTrigger");ElementTrigger.prototype.initialize=function(){},ElementTrigger.prototype.update=function(e){};var ElementTriggerDescription=pc.createScript("elementTriggerDescription");ElementTriggerDescription.prototype.initialize=function(){this.app.on("element:start",this.triggerstart,this),this.app.on("element:end",this.triggerend,this),this.active=0,this.alpha=0},ElementTriggerDescription.prototype.update=function(t){this.alpha+=t*this.active,this.alpha<0?(this.alpha=0,this.active=0):this.alpha>1&&(this.alpha=1),this.entity.setLocalPosition(0,this.lerpe(-200,50,this.alpha),0)},ElementTriggerDescription.prototype.triggerstart=function(t){this.active=1,this.alpha=0},ElementTriggerDescription.prototype.triggerend=function(t){this.active=-1},ElementTriggerDescription.prototype.lerpe=function(t,i,e){return t+(1-Math.pow(1-e,3))*(i-t)};var ElementTriggerButton=pc.createScript("elementTriggerButton");ElementTriggerButton.attributes.add("initialPos",{type:"number",default:5}),ElementTriggerButton.prototype.initialize=function(){this.entity.button.on("hoverstart",this.hoverstart,this),this.entity.button.on("hoverend",this.hoverend,this),this.entity.button.on("click",this.click,this),this.active=0,this.alpha=0,this.app.on("element:start",(function(t){this.name=t}),this)},ElementTriggerButton.prototype.update=function(t){this.alpha+=t*this.active,this.alpha>1?this.alpha=1:this.alpha<0&&(this.alpha=0),this.entity.findByName("text").setLocalPosition(this.lerpe(this.initialPos,0,this.alpha),this.entity.findByName("text").getLocalPosition().y,this.entity.findByName("text").getLocalPosition().z)},ElementTriggerButton.prototype.hoverstart=function(t){this.alpha=0,this.active=1},ElementTriggerButton.prototype.hoverend=function(t){this.active=-1},ElementTriggerButton.prototype.click=function(t){console.log(this.name,this.entity.name),this.app.fire("element:end")},ElementTriggerButton.prototype.lerpe=function(t,e,i){return t+(1-Math.pow(1-i,3))*(e-t)};var Billboard=pc.createScript("billboard");Billboard.attributes.add("player",{type:"entity",title:"targetPlayer"}),Billboard.prototype.initialize=function(){},Billboard.prototype.update=function(t){this.entity.setEulerAngles(this.player.getEulerAngles())};var EntranceEnter=pc.createScript("entranceEnter");EntranceEnter.attributes.add("player",{type:"entity",title:"targetPlayer"}),EntranceEnter.prototype.initialize=function(){this.entity.button.on("click",this.click,this)},EntranceEnter.prototype.update=function(t){},EntranceEnter.prototype.click=function(t){this.player.setPosition(this.entity.getPosition()),this.app.fire("cameraswitch:trigger"),console.log(this.player.getPosition())};var OpacityElementTrigger=pc.createScript("opacityElementTrigger");OpacityElementTrigger.prototype.initialize=function(){this.app.on("element:start",this.triggerstart,this),this.app.on("element:end",this.triggerend,this),this.active=0,this.alpha=0},OpacityElementTrigger.prototype.update=function(t){this.alpha+=t*this.active,this.alpha<0?(this.alpha=0,this.active=0):this.alpha>1&&(this.alpha=1),this.entity.element.opacity=this.lerpe(0,1,this.alpha)},OpacityElementTrigger.prototype.triggerstart=function(t){this.entity.element.text==t?(this.active=1,this.alpha=0):this.active=-1},OpacityElementTrigger.prototype.triggerend=function(t){this.active=-1},OpacityElementTrigger.prototype.lerpe=function(t,e,i){return t+(1-Math.pow(1-i,3))*(e-t)};var TriggerDescription=pc.createScript("triggerDescription");TriggerDescription.prototype.initialize=function(){this.entity.button.on("click",this.click,this)},TriggerDescription.prototype.update=function(i){},TriggerDescription.prototype.click=function(i){this.app.fire("triggerDecription")};var TriggerDescriptionShow=pc.createScript("triggerDescriptionShow");TriggerDescriptionShow.attributes.add("top",{type:"number",title:"Uptowhere"}),TriggerDescriptionShow.prototype.initialize=function(){this.app.on("triggerDecription",this.triggerstart,this),this.app.on("element:end",this.triggerend,this),this.active=-1,this.alpha=0,this.app.on("element:start",(function(t){this.name=t}),this)},TriggerDescriptionShow.prototype.update=function(t){this.alpha+=t*this.active,this.alpha<0?(this.alpha=0,this.active=0):this.alpha>1&&(this.alpha=1),this.change(this.lerpe(0,1,this.alpha))},TriggerDescriptionShow.prototype.triggerstart=function(t){console.log("trigger Started"),this.entity.element.text==this.name&1!=this.active?(this.active=1,this.alpha=0):this.active=-1},TriggerDescriptionShow.prototype.change=function(t){this.entity.findByName("description").setLocalScale(t,t,t),this.entity.setLocalPosition(0,pc.math.lerp(0,this.top,t),0);const i=pc.math.lerp(1,.5,t);this.entity.setLocalScale(i,i,i)},TriggerDescriptionShow.prototype.triggerend=function(t){this.active=-1},TriggerDescriptionShow.prototype.lerpe=function(t,i,e){return t+(1-Math.pow(1-e,3))*(i-t)};var SwitchHistory=pc.createScript("switchHistory");SwitchHistory.attributes.add("triggerEntity",{type:"entity",title:"Trigger Entity"}),SwitchHistory.prototype.initialize=function(){this.app.on("history:modelchange",this.changeModel,this)},SwitchHistory.prototype.update=function(t){},SwitchHistory.prototype.changeModel=function(t){for(var i=0;i<this.triggerEntity.children.length;i++)console.log(this.triggerEntity.children[t]),this.triggerEntity.children[i].enabled=t==i};var ScreenSize=pc.createScript("screenSize");ScreenSize.prototype.initialize=function(){if(pc.platform.ios){var i=this.app.graphicsDevice.width*this.app.graphicsDevice.height,e=727040,a=3145728;i<=e&&(this.app.graphicsDevice.maxPixelRatio=2),i>e&&i<=a&&(this.app.graphicsDevice.maxPixelRatio=Math.min(window.devicePixelRatio,1.5)),i>a&&(this.app.graphicsDevice.maxPixelRatio=Math.min(window.devicePixelRatio,1))}},ScreenSize.prototype.update=function(i){};var Scaleanimation=pc.createScript("scaleanimation");Scaleanimation.prototype.initialize=function(){this.alpha=0},Scaleanimation.prototype.update=function(a){this.alpha+=a;const t=1+.1*Math.sin(2*this.alpha);this.entity.setLocalScale(t,t,t)};